<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2024-10-14" />

<title>Differential Expression Analysis</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<!--
Favicon dervied from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="shortcut icon" href="favicon-16x16.png" />
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to scRNA-Seq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="workshop_intro.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00A-OrientingOnScRNASeq.html">Orienting on scRNA-Seq</a>
    </li>
    <li>
      <a href="01-GettingStarted.html">Getting Started with Seurat</a>
    </li>
    <li>
      <a href="00B-CellRangerInAction.html">Cell Ranger in Action</a>
    </li>
    <li>
      <a href="02-QCandFiltering.html">Secondary QC &amp; Filtering</a>
    </li>
    <li>
      <a href="03-Normalization.html">Normalization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04-PCAandIntegration.html">PCA &amp; Integration</a>
    </li>
    <li>
      <a href="05-ProjectionAndClustering.html">Projection &amp; Clustering</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-MarkerVisualization.html">Marker identification and visualization</a>
    </li>
    <li>
      <a href="07-CellTypeAnnos.html">Cell type annotation</a>
    </li>
    <li>
      <a href="08-DifferentialExpression.html">Differential expression analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="workshop_wrap_up.html">Wrap up</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Differential Expression Analysis</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2024-10-14</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}

table.fig, th.fig, td.fig {
  border: 1px solid black;
  border-collapse: collapse;
  padding: 15px;
}
</style>
<script>
  addClassKlippyTo("pre.r, pre.markdown, pre.bash");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div id="workflow-overview" class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Workflow Overview</h1>
<p><br/>
<img src="images/wayfinder/wayfinder.png" alt="wayfinder" style="height: 400px;"/>
<br/> <br/></p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Differential expression comparison is a key step to addressing the
biological question at hand for the experiment, namely what genes might
be contributing to the aberrant bone formation during healing that was
observed in this experiment.</p>
<table class="fig">
<tr class="fig">
<td class="fig">
<img src="images/graphical_abstracts/graphical_abstract_diffex.png" />
</td>
</tr>
<tr class="fig">
<td class="fig">
A. For differential expression, we consider a single cluster at a time.
<br/> B. For the cluster of interest, the cells are partitioned into
case vs control (or other appropriate groupings) and expression compared
across all genes. <br/> C. Comparisons produce lists and visualizations
of differently expressed genes across conditions.
</td>
</tr>
</table>
<p><br/></p>
<p>As a reminder, our data includes cells isolated from issue from day 0
(prior to injury) as controls, and days 7 and 21 post-injury as
experimental conditions.</p>
<p><img src="images/curriculum/experimental_design.jpg" /></p>
<p>We already introduced DE comparisons in the <a
href="06-MarkerVisualization.html">marker identification section of this
workshop</a>, but here we will show how to run comparisons between
experimental conditions for each annotated cluster.</p>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<!--Add specific goals for section-->
<ul>
<li>Run cell-level differential expression comparisons</li>
<li>Run sample level differential expression comparisons</li>
</ul>
<hr />
</div>
</div>
<div id="differential-expression" class="section level1">
<h1>Differential Expression</h1>
<p>For single-cell data there are generally two types approaches for
running differential expression - either a cell-level or sample-level
approach.</p>
<p>For cell-level comparisons, simpler statistical methods like a t-test
or the Wilcoxon rank-sum test or single-cell specific methods that
models cells individually like <a
href="https://doi.org/10.1186/s13059-015-0844-5">MAST</a> can be
used.</p>
<p>As mentioned earlier, many of the tools developed for bulk RNA-seq
have been shown to have good performance for single-cell data, such as
EdgeR or DESeq2, particularly when the count data is aggregated into
sample-level “pseudobulk” values for each cluster <a
href="https://www.sc-best-practices.org/conditions/differential_gene_expression.html">source</a>.</p>
<p>As discussed in the <a
href="https://www.sc-best-practices.org/conditions/differential_gene_expression.html">single-cell
best practices book</a> and in the <a
href="https://ouyanglab.com/singlecell/clust.html#sec:diffexpr">Ouyang
Lab’s marker gene identification materials</a>, there are active
benchmarking efforts and threshold considerations for single-cell
data.</p>
<!-- add more in depth model comparisons options later?
## Model options

Wilcoxon (default), DESeq2, MAST, etc.
-->
<div id="standard-comparisons" class="section level2">
<h2>Standard comparisons</h2>
<p>First we’ll run cell-level comparisons for our data for the pericyte
cluster, starting with cells from the D21 vs D7 conditions. We’ll need
to ensure our cells are labeled to reflect both the cluster and
condition identities before running our comparison using
<code>FindMarker()</code> and summarizing the results:</p>
<!-- add UMAP with facets by groups to show what's being compared? -->
<pre class="r"><code># set up combined label of day + celltype &amp; assign as identities
geo_so$day.celltype = paste(geo_so$day, geo_so$cell_type, sep = &#39;_&#39;)
# check labels
unique(geo_so$day.celltype)</code></pre>
<pre><code> [1] &quot;Day0_Stem Cell&quot;                &quot;Day0_Macrophage&quot;              
 [3] &quot;Day0_Pericyte&quot;                 &quot;Day0_Hematopoietic Stem Cell&quot; 
 [5] &quot;Day0_Dendritic Cell&quot;           &quot;Day0_CD8+ T Cell&quot;             
 [7] &quot;Day0_Muscle Satellite Cell&quot;    &quot;Day0_Unknown&quot;                 
 [9] &quot;Day0_Regulatory T Cell&quot;        &quot;Day0_Hematopoetic precursor&quot;  
[11] &quot;Day21_Hematopoietic Stem Cell&quot; &quot;Day21_Dendritic Cell&quot;         
[13] &quot;Day21_Macrophage&quot;              &quot;Day21_Stem Cell&quot;              
[15] &quot;Day21_Pericyte&quot;                &quot;Day21_Muscle Satellite Cell&quot;  
[17] &quot;Day21_Regulatory T Cell&quot;       &quot;Day21_Hematopoetic precursor&quot; 
[19] &quot;Day21_Unknown&quot;                 &quot;Day21_CD8+ T Cell&quot;            
[21] &quot;Day21_Muscle Progenitor Cell&quot;  &quot;Day7_Hematopoietic Stem Cell&quot; 
[23] &quot;Day7_Dendritic Cell&quot;           &quot;Day7_Pericyte&quot;                
[25] &quot;Day7_Stem Cell&quot;                &quot;Day7_Macrophage&quot;              
[27] &quot;Day7_Muscle Progenitor Cell&quot;   &quot;Day7_CD8+ T Cell&quot;             
[29] &quot;Day7_Regulatory T Cell&quot;        &quot;Day7_Muscle Satellite Cell&quot;   
[31] &quot;Day7_Unknown&quot;                  &quot;Day7_Hematopoetic precursor&quot;  </code></pre>
<pre class="r"><code># Reset cell identities to the combined condition + cluster label
Idents(geo_so) = &#39;day.celltype&#39;

# run comparison for D21 vs D0, using wilcoxon test
de_cell_pericyte_D21_vs_D7 = FindMarkers(
    object = geo_so,
    slot = &#39;data&#39;, test = &#39;wilcox&#39;,
    ident.1 = &#39;Day21_Pericyte&#39;, ident.2 = &#39;Day7_Pericyte&#39;)

head(de_cell_pericyte_D21_vs_D7)</code></pre>
<pre><code>                p_val avg_log2FC pct.1 pct.2     p_val_adj
Prelp    0.000000e+00  2.4618522 0.736 0.225  0.000000e+00
Fmod     0.000000e+00  2.3478790 0.851 0.442  0.000000e+00
Gm10076  0.000000e+00 -1.2167588 0.818 0.966  0.000000e+00
Tpt1     0.000000e+00  0.7830756 0.997 0.984  0.000000e+00
Cilp2   2.572417e-295  5.8178344 0.355 0.012 5.264709e-291
Wfdc1   4.579283e-292  5.5652383 0.342 0.008 9.371961e-288</code></pre>
<pre class="r"><code># Add rownames as a column for output
de_cell_pericyte_D21_vs_D7$gene = rownames(de_cell_pericyte_D21_vs_D7)

# summarize our results
table(de_cell_pericyte_D21_vs_D7$p_val_adj &lt; 0.05 &amp; abs(de_cell_pericyte_D21_vs_D7$avg_log2FC) &gt; 1.5)</code></pre>
<pre><code>
FALSE  TRUE 
 9226   503 </code></pre>
<pre class="r"><code>write_csv(de_cell_pericyte_D21_vs_D7, file = &#39;results/tables/de_standard_pericyte_D21_vs_D7.csv&#39;)</code></pre>
<p>In the first 3 lines of the above code block we can see the changes
to the schematic:</p>
<div class="float">
<img src="images/seurat_schematic/Slide13.png"
alt="Image: Schematic after setting the Idents()." />
<div class="figcaption">Image: Schematic after setting the
Idents().</div>
</div>
<p>Note - the <code>avg_log2FC</code> threshold of 1.5 we use here are
quite stringent as the default log2FC threshold for the function is
0.25. However the default threshold corresponds to only a 19% difference
in RNA levels, which is quite permissive.</p>
<p>If there is enough time - we can also compare between cells from the
D7 and D0 conditions.</p>
<pre class="r"><code># run comparison for D7 vs D0, using wilcoxon test
de_cell_pericyte_D7_vs_D0 = FindMarkers(
    object = geo_so,
    slot = &#39;data&#39;, test = &#39;wilcox&#39;,
    ident.1 = &#39;Day7_Pericyte&#39;, ident.2 = &#39;Day0_Pericyte&#39;)

head(de_cell_pericyte_D7_vs_D0)</code></pre>
<pre><code>              p_val avg_log2FC pct.1 pct.2     p_val_adj
Myoc  3.107048e-229  -7.891927 0.005 0.382 6.358885e-225
Chad  4.253214e-215  -9.575883 0.002 0.290 8.704628e-211
Vit   8.365220e-207  -6.393371 0.006 0.366 1.712026e-202
Cilp2 1.424816e-186  -7.228151 0.012 0.412 2.916029e-182
Ptx4  1.895882e-176  -6.709085 0.004 0.290 3.880112e-172
Hmcn2 8.241405e-174  -6.519140 0.009 0.366 1.686686e-169</code></pre>
<pre class="r"><code># Add rownames as a column for output
de_cell_pericyte_D7_vs_D0$gene = rownames(de_cell_pericyte_D7_vs_D0)

# summarize results
table(de_cell_pericyte_D7_vs_D0$p_val_adj &lt; 0.05 &amp; abs(de_cell_pericyte_D7_vs_D0$avg_log2FC) &gt; 1.5)</code></pre>
<pre><code>
FALSE  TRUE 
10339  1200 </code></pre>
<p>This same approach can be extended to run pairwise comparisons
between conditions for each annotated cluster of interest.</p>
<!-- add code to loop through all clusters and generate comparisons -->
</div>
<div id="pseudobulk-comparisons" class="section level2">
<h2>Pseudobulk comparisons</h2>
<!-- [10x analysis guide for differential expression with biological replicates](https://www.10xgenomics.com/analysis-guides/differential-gene-expression-analysis-in-scrna-seq-data-between-conditions-with-biological-replicates) -->
<!-- [Ouyang](https://ouyanglab.com/singlecell/clust.html#sec:diffexpr) For (ii), single-cell studies are now more complex, often including samples from multiple donors. It is possible that there are more cells being profiled from a specific donor than others and this can skew the DE results. For example, consider a study where there are three diseased samples (D1,D2,D3) and three healthy samples (H1,H2,H3_ and there are a lot more cells from sample D1. In this scenario, a gene that is specifically expressed in D1 may be identified as differentially expressed when comparing diseased and healthy single-cells. In fact, Squair et al. have shown that ignoring biological replicates can often result in false discoveries in single-cell DE (Squair et al. 2021). To circumvent this, Squair et al. suggested the use of pseudo-bulk profiles where the single-cell profiles from each individual is being collected and then subjected to bulk RNA-seq based DE methods. Another possible approach is to downsample the number of single cells such that each individual have roughly a similar number of cells. -->
<p>With advances in the technology as well as decreased sequencing costs
allowing for larger scale single-cell experiments (that include
replicates), along with a study by <a
href="https://www.nature.com/articles/s41467-021-25960-2">Squair et al
(2021)</a> that highlighted the possibility of inflated false discovery
rates for the cell-level approaches since cells isolated from the same
sample are unlikely to be statistically independent <a
href="https://www.sc-best-practices.org/conditions/differential_gene_expression.html">source</a>
the use of sample-level or “psuedobulk” can be advantageous.</p>
<!-- add UMAP with facets by sample to show what's being compared? -->
<p>We’ll run psuedobulk comparisons for our data for the monocyte
cluster, starting with the D21 vs D0 conditions. We’ll need to generate
the aggregated counts first (ensuring that we are grouping cells by
replicate labels), before labeling the cells to reflect the cluster and
condition. Then we will run our comparison using
<code>FindMarker()</code> but specifying DESeq2 as our method before
summarizing the results:</p>
<pre class="r"><code># Create pseudobulk 
pseudo_catch_so = AggregateExpression(geo_so, assays = &#39;RNA&#39;, return.seurat = TRUE, group.by = c(&#39;cell_type&#39;, &#39;day&#39;, &#39;replicate&#39;))

# Set up labels to use for comparisons &amp; assign as cell identities
pseudo_catch_so$day.celltype = paste(pseudo_catch_so$day, pseudo_catch_so$cell_type, sep = &#39;_&#39;)
Idents(pseudo_catch_so) = &#39;day.celltype&#39;

# Run pseudobulk comparison between Day 21 and Day 0, using DESeq2
de_pseudo_pericyte_D21_vs_D7 = FindMarkers(
    object = pseudo_catch_so, 
    ident.1 = &#39;Day21_Pericyte&#39;, ident.2 = &#39;Day7_Pericyte&#39;, 
    test.use = &#39;DESeq2&#39;)

# Take a look at the table
head(de_pseudo_pericyte_D21_vs_D7)</code></pre>
<pre><code>               p_val avg_log2FC pct.1 pct.2     p_val_adj
Cilp2  1.971538e-247  4.8995439     1     1 5.222408e-243
Cd55   8.094150e-143  1.4764380     1     1 2.144059e-138
Ltbp4  2.302440e-102  1.3481250     1     1  6.098932e-98
Prelp   1.287181e-96  1.7399832     1     1  3.409613e-92
Lamb2   1.272952e-89  0.5651106     1     1  3.371923e-85
H2-Ab1  2.863968e-86 -3.9988630     1     1  7.586366e-82</code></pre>
<pre class="r"><code># Add rownames as a column for output
de_pseudo_pericyte_D21_vs_D7$gene = rownames(de_pseudo_pericyte_D21_vs_D7)

# look at results, using the same thresholds
table(de_pseudo_pericyte_D21_vs_D7$p_val_adj &lt; 0.05 &amp; abs(de_pseudo_pericyte_D21_vs_D7$avg_log2FC) &gt; 1.5)</code></pre>
<pre><code>
FALSE  TRUE 
23136   940 </code></pre>
<pre class="r"><code># output results
write_csv(de_pseudo_pericyte_D21_vs_D7, file = &#39;results/tables/de_pseudo_pericyte_D21_vs_D7.csv&#39;)</code></pre>
<p>Since we’re working with pseudobulk data, unlike in the marker
identification section, there is no percentage of cells expressing to
need to represent so we can summarize our DE results with a volcano
plot:</p>
<pre class="r"><code>pseudo_pericyte_D21_vs_D7_volcano = ggplot(de_pseudo_pericyte_D21_vs_D7, aes(x = avg_log2FC, y = -log10(p_val))) + geom_point()
pseudo_pericyte_D21_vs_D7_volcano</code></pre>
<p><img src="images/curriculum/08-DifferentialExpression/08-de_pseudobulk_volcano-1.png" width="816" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggsave(filename = &#39;results/figures/volcano_de_pseudo_pericyte_D21_vs_D0.png&#39;, plot = pseudo_pericyte_D21_vs_D7_volcano, width = 7, height = 7, units = &#39;in&#39;)</code></pre>
<!--- 
### Iterating over all clusters

Add code to generate pseudobulk results for each cluster for all Day 7 vs Day 21 comparisons
--->
<div id="further-examining-de-results" class="section level3">
<h3>Further examining DE results</h3>
<p>We can also overlay the expression of interesting differentially
expressed genes back onto our UMAP plots to highlight the localization
and possible function, again using the <code>FeaturePlot</code>
function.</p>
<pre class="r"><code>FeaturePlot(geo_so, features = &quot;Cd55&quot;, split.by = &quot;day&quot;)</code></pre>
<p><img src="images/curriculum/08-DifferentialExpression/08-show_DE_featurePlot-1.png" width="816" style="display: block; margin: auto;" />
So we found Cd55 based on differential expression comparison in the
Pericyte population between Day 7 and Day 21 but in looking at the
Feature plot of expression, we also see high expression in a subset of
cells on Day 0. This interesting, since according to <a
href="https://onlinelibrary.wiley.com/doi/full/10.1002/jbmr.3861">Shin
et al (2019)</a>, CD55 regulates bone mass in mice.</p>
<p>It also looks like there is a high percentage of expression in a
subpopulation of the other two precursor/stem cell populations on the
top right of our plots, which is interesting and might suggest an
interesting subpopulation that we might try to identify, particularly
given the role of this gene and our interest in determining why abberant
bone can form after injury.</p>
</div>
</div>
<div id="next-steps" class="section level2">
<h2>Next steps</h2>
<p>While looking at individual genes can reveal interesting patterns
like in the case of Cd55, it’s not a very efficient process. So after
running ‘standard’ and/or psuedobulk differential expression
comparisons, we can use the same types of tools used downstream of bulk
RNA-seq to interpret these results, such as GO term enrichment, KEGG
pathway enrichment, and GSEA with mSigDB.</p>
</div>
</div>
<div id="save-our-progress" class="section level1">
<h1>Save our progress</h1>
<p>We’ll save the scCATCH object. The Seurat object has not been changed
in this module.</p>
<pre class="r"><code>saveRDS(geo_so, file = &#39;results/rdata/geo_so_sct_integrated_final.rds&#39;)</code></pre>
<hr />
</div>
<div id="downstream-approaches" class="section level1">
<h1>Downstream approaches</h1>
<p>Beyond differential expression within clusters and , there are many
other possible avenues of exploration and analysis for scRNA-seq data.
Including, but not limited to:</p>
<ul>
<li><p>Integration with other modalities (e.g. ATAC-seq, VDJ,
etc.)</p></li>
<li><p>Subclustering clusters of interest, see <a
href="https://hbctraining.github.io/scRNA-seq_online/lessons/seurat_subclustering.html">HBC’s
summary on subclustering</a>, <a
href="https://satijalab.org/seurat/reference/findsubcluster">Seurat’s
findSubcCluster documentation</a> and <a
href="https://github.com/satijalab/seurat/issues/1883">this related
issue thread</a></p></li>
<li><p>Trajectory or Pseudotime analysis, see<a
href="https://ouyanglab.com/singlecell/dimrd.html">Ouyang Lab’s
trajectory analysis</a> or <a
href="https://broadinstitute.github.io/2020_scWorkshop/trajectory-analysis.html">Broad
Institute’s materials on trajectory analysis</a>, among other
resources</p></li>
<li><p>Cell - Cell communication network inference, see <a
href="https://www.nature.com/articles/s41587-023-01782-z">review by Wilk
et al (2023)</a></p></li>
<li><p>Velocity analysis (note: not compatible with the flex probe based
kits), see <a
href="https://www.sc-best-practices.org/trajectories/rna_velocity.html">the
chapter from the single-cells best practices book</a> for detailed
theory/modeling or the <a
href="https://pklab.med.harvard.edu/velocyto/notebooks/R/SCG71.nb.html">10x
data vignette for velocyto</a> for a practical example in R</p></li>
</ul>
<p>We would recommend looking for studies in similar tissues or
experimental questions and see what kind of approaches and tools were
used to answer questions related to your biological question</p>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Reviewing these results should allow us to identify genes of interest
that are impacted by injury and in the context of the cell-types in
which they are differentially expressed, formalize some hypotheses for
what cell-types or biological processes might be contributing to
aberrant bone formation.</p>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="07-CellTypeAnnos.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a href="workshop_wrap_up.html">Workshop Wrap
Up</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGlmZmVyZW50aWFsIEV4cHJlc3Npb24gQW5hbHlzaXMiCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIGluY2x1ZGVzOgogICAgICAgICAgICAgICAgaW5faGVhZGVyOiBoZWFkZXIuaHRtbAogICAgICAgICAgICB0aGVtZTogcGFwZXIKICAgICAgICAgICAgdG9jOiB0cnVlCiAgICAgICAgICAgIHRvY19kZXB0aDogNAogICAgICAgICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgICAgICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMThweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxMnB4Cn0KCnRhYmxlLmZpZywgdGguZmlnLCB0ZC5maWcgewogIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOwogIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgcGFkZGluZzogMTVweDsKfQo8L3N0eWxlPgoKYGBge3Iga2xpcHB5LCBlY2hvPUZBTFNFLCBpbmNsdWRlPVRSVUV9CmtsaXBweTo6a2xpcHB5KGxhbmcgPSBjKCJyIiwgIm1hcmtkb3duIiwgImJhc2giKSwgcG9zaXRpb24gPSBjKCJ0b3AiLCAicmlnaHQiKSkKYGBgCgpgYGB7ciwgaW5jbHVkZSA9IEZBTFNFfQpzb3VyY2UoIi4uL2Jpbi9jaHVuay1vcHRpb25zLlIiKQprbml0cl9maWdfcGF0aCgiMDgtRGlmZmVyZW50aWFsRXhwcmVzc2lvbi8wOC0iKQpgYGAKCiMgV29ya2Zsb3cgT3ZlcnZpZXcgey51bmxpc3RlZCAudW5udW1iZXJlZH0KCjxici8+CjxpbWcgc3JjPSJpbWFnZXMvd2F5ZmluZGVyL3dheWZpbmRlci5wbmciIGFsdD0id2F5ZmluZGVyIiBzdHlsZT0iaGVpZ2h0OiA0MDBweDsiLz4KPGJyLz4KPGJyLz4KCiMgSW50cm9kdWN0aW9uCgpEaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29uIGlzIGEga2V5IHN0ZXAgdG8gYWRkcmVzc2luZyB0aGUgYmlvbG9naWNhbCBxdWVzdGlvbiBhdCBoYW5kIGZvciB0aGUgZXhwZXJpbWVudCwgbmFtZWx5IHdoYXQgZ2VuZXMgbWlnaHQgYmUgY29udHJpYnV0aW5nIHRvIHRoZSBhYmVycmFudCBib25lIGZvcm1hdGlvbiBkdXJpbmcgaGVhbGluZyB0aGF0IHdhcyBvYnNlcnZlZCBpbiB0aGlzIGV4cGVyaW1lbnQuCgo8dGFibGUgY2xhc3M9J2ZpZyc+Cjx0ciBjbGFzcz0nZmlnJz48dGQgY2xhc3M9J2ZpZyc+IVtdKGltYWdlcy9ncmFwaGljYWxfYWJzdHJhY3RzL2dyYXBoaWNhbF9hYnN0cmFjdF9kaWZmZXgucG5nKTwvdGQ+PC90cj4KPHRyIGNsYXNzPSdmaWcnPjx0ZCBjbGFzcz0nZmlnJz5BLiBGb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24sIHdlIGNvbnNpZGVyIGEgc2luZ2xlIGNsdXN0ZXIgYXQgYSB0aW1lLiA8YnIvPgpCLiBGb3IgdGhlIGNsdXN0ZXIgb2YgaW50ZXJlc3QsIHRoZSBjZWxscyBhcmUgcGFydGl0aW9uZWQgaW50byBjYXNlIHZzIGNvbnRyb2wgKG9yIG90aGVyIGFwcHJvcHJpYXRlIGdyb3VwaW5ncykgYW5kIGV4cHJlc3Npb24gY29tcGFyZWQgYWNyb3NzIGFsbCBnZW5lcy4gPGJyLz4KQy4gQ29tcGFyaXNvbnMgcHJvZHVjZSBsaXN0cyBhbmQgdmlzdWFsaXphdGlvbnMgb2YgZGlmZmVyZW50bHkgZXhwcmVzc2VkIGdlbmVzIGFjcm9zcyBjb25kaXRpb25zLgo8L3RkPjwvdHI+CjwvdGFibGU+Cjxici8+CgpBcyBhIHJlbWluZGVyLCBvdXIgZGF0YSBpbmNsdWRlcyBjZWxscyBpc29sYXRlZCBmcm9tIGlzc3VlIGZyb20gZGF5IDAgKHByaW9yIHRvIGluanVyeSkgYXMgY29udHJvbHMsIGFuZCBkYXlzIDcgYW5kIDIxIHBvc3QtaW5qdXJ5IGFzIGV4cGVyaW1lbnRhbCBjb25kaXRpb25zLgoKIVtdKC4vaW1hZ2VzL2N1cnJpY3VsdW0vZXhwZXJpbWVudGFsX2Rlc2lnbi5qcGcpCgpXZSBhbHJlYWR5IGludHJvZHVjZWQgREUgY29tcGFyaXNvbnMgaW4gdGhlIFttYXJrZXIgaWRlbnRpZmljYXRpb24gc2VjdGlvbiBvZiB0aGlzIHdvcmtzaG9wXSgwNi1NYXJrZXJWaXN1YWxpemF0aW9uLmh0bWwpLCBidXQgaGVyZSB3ZSB3aWxsIHNob3cgaG93IHRvIHJ1biBjb21wYXJpc29ucyBiZXR3ZWVuIGV4cGVyaW1lbnRhbCBjb25kaXRpb25zIGZvciBlYWNoIGFubm90YXRlZCBjbHVzdGVyLgoKIyMgT2JqZWN0aXZlcwoKPCEtLUFkZCBzcGVjaWZpYyBnb2FscyBmb3Igc2VjdGlvbi0tPgotIFJ1biBjZWxsLWxldmVsIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGNvbXBhcmlzb25zCi0gUnVuIHNhbXBsZSBsZXZlbCBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29ucwoKLS0tLQoKYGBge3IsIHJlYWRfcmRzX2hpZGRlbiwgZWNobyA9IEZBTFNFLCB3YXJuaW5nID0gRkFMU0UsIG1lc3NhZ2UgPSBGQUxTRX0KaWYoIWV4aXN0cygnZ2VvX3NvJykpIHsKICBsaWJyYXJ5KFNldXJhdCkKICBsaWJyYXJ5KEJQQ2VsbHMpCiAgbGlicmFyeSh0aWR5dmVyc2UpCgogIG9wdGlvbnMoZnV0dXJlLmdsb2JhbHMubWF4U2l6ZSA9IDFlOSkKCiAgZ2VvX3NvID0gcmVhZFJEUygncmVzdWx0cy9yZGF0YS9nZW9fc29fc2N0X2ludGVncmF0ZWRfd2l0aF9jYXRjaC5yZHMnKQp9CmBgYAoKIyBEaWZmZXJlbnRpYWwgRXhwcmVzc2lvbgoKRm9yIHNpbmdsZS1jZWxsIGRhdGEgdGhlcmUgYXJlIGdlbmVyYWxseSB0d28gdHlwZXMgYXBwcm9hY2hlcyBmb3IgcnVubmluZyBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiAtIGVpdGhlciBhIGNlbGwtbGV2ZWwgb3Igc2FtcGxlLWxldmVsIGFwcHJvYWNoLiAKCkZvciBjZWxsLWxldmVsIGNvbXBhcmlzb25zLCBzaW1wbGVyIHN0YXRpc3RpY2FsIG1ldGhvZHMgbGlrZSBhIHQtdGVzdCBvciB0aGUgV2lsY294b24gcmFuay1zdW0gdGVzdCBvciBzaW5nbGUtY2VsbCBzcGVjaWZpYyBtZXRob2RzIHRoYXQgbW9kZWxzIGNlbGxzIGluZGl2aWR1YWxseSBsaWtlIFtNQVNUXShodHRwczovL2RvaS5vcmcvMTAuMTE4Ni9zMTMwNTktMDE1LTA4NDQtNSkgY2FuIGJlIHVzZWQuIAoKQXMgbWVudGlvbmVkIGVhcmxpZXIsIG1hbnkgb2YgdGhlIHRvb2xzIGRldmVsb3BlZCBmb3IgYnVsayBSTkEtc2VxIGhhdmUgYmVlbiBzaG93biB0byBoYXZlIGdvb2QgcGVyZm9ybWFuY2UgZm9yIHNpbmdsZS1jZWxsIGRhdGEsIHN1Y2ggYXMgRWRnZVIgb3IgREVTZXEyLCBwYXJ0aWN1bGFybHkgd2hlbiB0aGUgY291bnQgZGF0YSBpcyBhZ2dyZWdhdGVkIGludG8gc2FtcGxlLWxldmVsICJwc2V1ZG9idWxrIiB2YWx1ZXMgZm9yIGVhY2ggY2x1c3RlciBbc291cmNlXShodHRwczovL3d3dy5zYy1iZXN0LXByYWN0aWNlcy5vcmcvY29uZGl0aW9ucy9kaWZmZXJlbnRpYWxfZ2VuZV9leHByZXNzaW9uLmh0bWwpLiAKCkFzIGRpc2N1c3NlZCBpbiB0aGUgW3NpbmdsZS1jZWxsIGJlc3QgcHJhY3RpY2VzIGJvb2tdKGh0dHBzOi8vd3d3LnNjLWJlc3QtcHJhY3RpY2VzLm9yZy9jb25kaXRpb25zL2RpZmZlcmVudGlhbF9nZW5lX2V4cHJlc3Npb24uaHRtbCkgYW5kIGluIHRoZSBbT3V5YW5nIExhYidzIG1hcmtlciBnZW5lIGlkZW50aWZpY2F0aW9uIG1hdGVyaWFsc10oaHR0cHM6Ly9vdXlhbmdsYWIuY29tL3NpbmdsZWNlbGwvY2x1c3QuaHRtbCNzZWM6ZGlmZmV4cHIpLCB0aGVyZSBhcmUgYWN0aXZlIGJlbmNobWFya2luZyBlZmZvcnRzIGFuZCB0aHJlc2hvbGQgY29uc2lkZXJhdGlvbnMgZm9yIHNpbmdsZS1jZWxsIGRhdGEuCgo8IS0tIGFkZCBtb3JlIGluIGRlcHRoIG1vZGVsIGNvbXBhcmlzb25zIG9wdGlvbnMgbGF0ZXI/CiMjIE1vZGVsIG9wdGlvbnMKCldpbGNveG9uIChkZWZhdWx0KSwgREVTZXEyLCBNQVNULCBldGMuCi0tPgoKIyMgU3RhbmRhcmQgY29tcGFyaXNvbnMKCkZpcnN0IHdlJ2xsIHJ1biBjZWxsLWxldmVsIGNvbXBhcmlzb25zIGZvciBvdXIgZGF0YSBmb3IgdGhlIHBlcmljeXRlIGNsdXN0ZXIsIHN0YXJ0aW5nIHdpdGggY2VsbHMgZnJvbSB0aGUgRDIxIHZzIEQ3IGNvbmRpdGlvbnMuIFdlJ2xsIG5lZWQgdG8gZW5zdXJlIG91ciBjZWxscyBhcmUgbGFiZWxlZCB0byByZWZsZWN0IGJvdGggdGhlIGNsdXN0ZXIgYW5kIGNvbmRpdGlvbiBpZGVudGl0aWVzIGJlZm9yZSBydW5uaW5nIG91ciBjb21wYXJpc29uIHVzaW5nIGBGaW5kTWFya2VyKClgIGFuZCBzdW1tYXJpemluZyB0aGUgcmVzdWx0czoKCjwhLS0gYWRkIFVNQVAgd2l0aCBmYWNldHMgYnkgZ3JvdXBzIHRvIHNob3cgd2hhdCdzIGJlaW5nIGNvbXBhcmVkPyAtLT4KCmBgYHtyLCBkZV93aWxjb3gxLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KIyBzZXQgdXAgY29tYmluZWQgbGFiZWwgb2YgZGF5ICsgY2VsbHR5cGUgJiBhc3NpZ24gYXMgaWRlbnRpdGllcwpnZW9fc28kZGF5LmNlbGx0eXBlID0gcGFzdGUoZ2VvX3NvJGRheSwgZ2VvX3NvJGNlbGxfdHlwZSwgc2VwID0gJ18nKQojIGNoZWNrIGxhYmVscwp1bmlxdWUoZ2VvX3NvJGRheS5jZWxsdHlwZSkKCiMgUmVzZXQgY2VsbCBpZGVudGl0aWVzIHRvIHRoZSBjb21iaW5lZCBjb25kaXRpb24gKyBjbHVzdGVyIGxhYmVsCklkZW50cyhnZW9fc28pID0gJ2RheS5jZWxsdHlwZScKCiMgcnVuIGNvbXBhcmlzb24gZm9yIEQyMSB2cyBEMCwgdXNpbmcgd2lsY294b24gdGVzdApkZV9jZWxsX3BlcmljeXRlX0QyMV92c19ENyA9IEZpbmRNYXJrZXJzKAogICAgb2JqZWN0ID0gZ2VvX3NvLAogICAgc2xvdCA9ICdkYXRhJywgdGVzdCA9ICd3aWxjb3gnLAogICAgaWRlbnQuMSA9ICdEYXkyMV9QZXJpY3l0ZScsIGlkZW50LjIgPSAnRGF5N19QZXJpY3l0ZScpCgpoZWFkKGRlX2NlbGxfcGVyaWN5dGVfRDIxX3ZzX0Q3KQoKIyBBZGQgcm93bmFtZXMgYXMgYSBjb2x1bW4gZm9yIG91dHB1dApkZV9jZWxsX3BlcmljeXRlX0QyMV92c19ENyRnZW5lID0gcm93bmFtZXMoZGVfY2VsbF9wZXJpY3l0ZV9EMjFfdnNfRDcpCgojIHN1bW1hcml6ZSBvdXIgcmVzdWx0cwp0YWJsZShkZV9jZWxsX3BlcmljeXRlX0QyMV92c19ENyRwX3ZhbF9hZGogPCAwLjA1ICYgYWJzKGRlX2NlbGxfcGVyaWN5dGVfRDIxX3ZzX0Q3JGF2Z19sb2cyRkMpID4gMS41KQoKd3JpdGVfY3N2KGRlX2NlbGxfcGVyaWN5dGVfRDIxX3ZzX0Q3LCBmaWxlID0gJ3Jlc3VsdHMvdGFibGVzL2RlX3N0YW5kYXJkX3BlcmljeXRlX0QyMV92c19ENy5jc3YnKQpgYGAKCkluIHRoZSBmaXJzdCAzIGxpbmVzIG9mIHRoZSBhYm92ZSBjb2RlIGJsb2NrIHdlIGNhbiBzZWUgdGhlIGNoYW5nZXMgdG8gdGhlIHNjaGVtYXRpYzoKCiFbSW1hZ2U6IFNjaGVtYXRpYyBhZnRlciBzZXR0aW5nIHRoZSBJZGVudHMoKS5dKGltYWdlcy9zZXVyYXRfc2NoZW1hdGljL1NsaWRlMTMucG5nKQoKTm90ZSAtIHRoZSBgYXZnX2xvZzJGQ2AgdGhyZXNob2xkIG9mIDEuNSB3ZSB1c2UgaGVyZSBhcmUgcXVpdGUgc3RyaW5nZW50IGFzIHRoZSBkZWZhdWx0IGxvZzJGQyB0aHJlc2hvbGQgZm9yIHRoZSBmdW5jdGlvbiBpcyAwLjI1LiBIb3dldmVyIHRoZSBkZWZhdWx0IHRocmVzaG9sZCBjb3JyZXNwb25kcyB0byBvbmx5IGEgMTklIGRpZmZlcmVuY2UgaW4gUk5BIGxldmVscywgd2hpY2ggaXMgcXVpdGUgcGVybWlzc2l2ZS4gCgpJZiB0aGVyZSBpcyBlbm91Z2ggdGltZSAtIHdlIGNhbiBhbHNvIGNvbXBhcmUgYmV0d2VlbiBjZWxscyBmcm9tIHRoZSBENyBhbmQgRDAgY29uZGl0aW9ucy4KCmBgYHtyLCBkZV93aWxjb3gyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KIyBydW4gY29tcGFyaXNvbiBmb3IgRDcgdnMgRDAsIHVzaW5nIHdpbGNveG9uIHRlc3QKZGVfY2VsbF9wZXJpY3l0ZV9EN192c19EMCA9IEZpbmRNYXJrZXJzKAogICAgb2JqZWN0ID0gZ2VvX3NvLAogICAgc2xvdCA9ICdkYXRhJywgdGVzdCA9ICd3aWxjb3gnLAogICAgaWRlbnQuMSA9ICdEYXk3X1BlcmljeXRlJywgaWRlbnQuMiA9ICdEYXkwX1BlcmljeXRlJykKCmhlYWQoZGVfY2VsbF9wZXJpY3l0ZV9EN192c19EMCkKCiMgQWRkIHJvd25hbWVzIGFzIGEgY29sdW1uIGZvciBvdXRwdXQKZGVfY2VsbF9wZXJpY3l0ZV9EN192c19EMCRnZW5lID0gcm93bmFtZXMoZGVfY2VsbF9wZXJpY3l0ZV9EN192c19EMCkKCiMgc3VtbWFyaXplIHJlc3VsdHMKdGFibGUoZGVfY2VsbF9wZXJpY3l0ZV9EN192c19EMCRwX3ZhbF9hZGogPCAwLjA1ICYgYWJzKGRlX2NlbGxfcGVyaWN5dGVfRDdfdnNfRDAkYXZnX2xvZzJGQykgPiAxLjUpCmBgYAoKVGhpcyBzYW1lIGFwcHJvYWNoIGNhbiBiZSBleHRlbmRlZCB0byBydW4gcGFpcndpc2UgY29tcGFyaXNvbnMgYmV0d2VlbiBjb25kaXRpb25zIGZvciBlYWNoIGFubm90YXRlZCBjbHVzdGVyIG9mIGludGVyZXN0LgoKPCEtLSBhZGQgY29kZSB0byBsb29wIHRocm91Z2ggYWxsIGNsdXN0ZXJzIGFuZCBnZW5lcmF0ZSBjb21wYXJpc29ucyAtLT4KCiMjIFBzZXVkb2J1bGsgY29tcGFyaXNvbnMKCjwhLS0gWzEweCBhbmFseXNpcyBndWlkZSBmb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gd2l0aCBiaW9sb2dpY2FsIHJlcGxpY2F0ZXNdKGh0dHBzOi8vd3d3LjEweGdlbm9taWNzLmNvbS9hbmFseXNpcy1ndWlkZXMvZGlmZmVyZW50aWFsLWdlbmUtZXhwcmVzc2lvbi1hbmFseXNpcy1pbi1zY3JuYS1zZXEtZGF0YS1iZXR3ZWVuLWNvbmRpdGlvbnMtd2l0aC1iaW9sb2dpY2FsLXJlcGxpY2F0ZXMpIC0tPgoKPCEtLSBbT3V5YW5nXShodHRwczovL291eWFuZ2xhYi5jb20vc2luZ2xlY2VsbC9jbHVzdC5odG1sI3NlYzpkaWZmZXhwcikgRm9yIChpaSksIHNpbmdsZS1jZWxsIHN0dWRpZXMgYXJlIG5vdyBtb3JlIGNvbXBsZXgsIG9mdGVuIGluY2x1ZGluZyBzYW1wbGVzIGZyb20gbXVsdGlwbGUgZG9ub3JzLiBJdCBpcyBwb3NzaWJsZSB0aGF0IHRoZXJlIGFyZSBtb3JlIGNlbGxzIGJlaW5nIHByb2ZpbGVkIGZyb20gYSBzcGVjaWZpYyBkb25vciB0aGFuIG90aGVycyBhbmQgdGhpcyBjYW4gc2tldyB0aGUgREUgcmVzdWx0cy4gRm9yIGV4YW1wbGUsIGNvbnNpZGVyIGEgc3R1ZHkgd2hlcmUgdGhlcmUgYXJlIHRocmVlIGRpc2Vhc2VkIHNhbXBsZXMgKEQxLEQyLEQzKSBhbmQgdGhyZWUgaGVhbHRoeSBzYW1wbGVzIChIMSxIMixIM18gYW5kIHRoZXJlIGFyZSBhIGxvdCBtb3JlIGNlbGxzIGZyb20gc2FtcGxlIEQxLiBJbiB0aGlzIHNjZW5hcmlvLCBhIGdlbmUgdGhhdCBpcyBzcGVjaWZpY2FsbHkgZXhwcmVzc2VkIGluIEQxIG1heSBiZSBpZGVudGlmaWVkIGFzIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCB3aGVuIGNvbXBhcmluZyBkaXNlYXNlZCBhbmQgaGVhbHRoeSBzaW5nbGUtY2VsbHMuIEluIGZhY3QsIFNxdWFpciBldCBhbC4gaGF2ZSBzaG93biB0aGF0IGlnbm9yaW5nIGJpb2xvZ2ljYWwgcmVwbGljYXRlcyBjYW4gb2Z0ZW4gcmVzdWx0IGluIGZhbHNlIGRpc2NvdmVyaWVzIGluIHNpbmdsZS1jZWxsIERFIChTcXVhaXIgZXQgYWwuIDIwMjEpLiBUbyBjaXJjdW12ZW50IHRoaXMsIFNxdWFpciBldCBhbC4gc3VnZ2VzdGVkIHRoZSB1c2Ugb2YgcHNldWRvLWJ1bGsgcHJvZmlsZXMgd2hlcmUgdGhlIHNpbmdsZS1jZWxsIHByb2ZpbGVzIGZyb20gZWFjaCBpbmRpdmlkdWFsIGlzIGJlaW5nIGNvbGxlY3RlZCBhbmQgdGhlbiBzdWJqZWN0ZWQgdG8gYnVsayBSTkEtc2VxIGJhc2VkIERFIG1ldGhvZHMuIEFub3RoZXIgcG9zc2libGUgYXBwcm9hY2ggaXMgdG8gZG93bnNhbXBsZSB0aGUgbnVtYmVyIG9mIHNpbmdsZSBjZWxscyBzdWNoIHRoYXQgZWFjaCBpbmRpdmlkdWFsIGhhdmUgcm91Z2hseSBhIHNpbWlsYXIgbnVtYmVyIG9mIGNlbGxzLiAtLT4KCldpdGggYWR2YW5jZXMgaW4gdGhlIHRlY2hub2xvZ3kgYXMgd2VsbCBhcyBkZWNyZWFzZWQgc2VxdWVuY2luZyBjb3N0cyBhbGxvd2luZyBmb3IgbGFyZ2VyIHNjYWxlIHNpbmdsZS1jZWxsIGV4cGVyaW1lbnRzICh0aGF0IGluY2x1ZGUgcmVwbGljYXRlcyksIGFsb25nIHdpdGggYSBzdHVkeSBieSBbU3F1YWlyIGV0IGFsICgyMDIxKV0oaHR0cHM6Ly93d3cubmF0dXJlLmNvbS9hcnRpY2xlcy9zNDE0NjctMDIxLTI1OTYwLTIpIHRoYXQgaGlnaGxpZ2h0ZWQgdGhlIHBvc3NpYmlsaXR5IG9mIGluZmxhdGVkIGZhbHNlIGRpc2NvdmVyeSByYXRlcyBmb3IgdGhlIGNlbGwtbGV2ZWwgYXBwcm9hY2hlcyBzaW5jZSBjZWxscyBpc29sYXRlZCBmcm9tIHRoZSBzYW1lIHNhbXBsZSBhcmUgdW5saWtlbHkgdG8gYmUgc3RhdGlzdGljYWxseSBpbmRlcGVuZGVudCBbc291cmNlXShodHRwczovL3d3dy5zYy1iZXN0LXByYWN0aWNlcy5vcmcvY29uZGl0aW9ucy9kaWZmZXJlbnRpYWxfZ2VuZV9leHByZXNzaW9uLmh0bWwpIHRoZSB1c2Ugb2Ygc2FtcGxlLWxldmVsIG9yICJwc3VlZG9idWxrIiBjYW4gYmUgYWR2YW50YWdlb3VzLiAKCjwhLS0gYWRkIFVNQVAgd2l0aCBmYWNldHMgYnkgc2FtcGxlIHRvIHNob3cgd2hhdCdzIGJlaW5nIGNvbXBhcmVkPyAtLT4KCldlJ2xsIHJ1biBwc3VlZG9idWxrIGNvbXBhcmlzb25zIGZvciBvdXIgZGF0YSBmb3IgdGhlIG1vbm9jeXRlIGNsdXN0ZXIsIHN0YXJ0aW5nIHdpdGggdGhlIEQyMSB2cyBEMCBjb25kaXRpb25zLiBXZSdsbCBuZWVkIHRvIGdlbmVyYXRlIHRoZSBhZ2dyZWdhdGVkIGNvdW50cyBmaXJzdCAoZW5zdXJpbmcgdGhhdCB3ZSBhcmUgZ3JvdXBpbmcgY2VsbHMgYnkgcmVwbGljYXRlIGxhYmVscyksIGJlZm9yZSBsYWJlbGluZyB0aGUgY2VsbHMgdG8gcmVmbGVjdCB0aGUgY2x1c3RlciBhbmQgY29uZGl0aW9uLiBUaGVuIHdlIHdpbGwgcnVuIG91ciBjb21wYXJpc29uIHVzaW5nIGBGaW5kTWFya2VyKClgIGJ1dCBzcGVjaWZ5aW5nIERFU2VxMiBhcyBvdXIgbWV0aG9kIGJlZm9yZSBzdW1tYXJpemluZyB0aGUgcmVzdWx0czoKCmBgYHtyLCBkZV9wc2V1ZG9idWxrLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0KIyBDcmVhdGUgcHNldWRvYnVsayAKcHNldWRvX2NhdGNoX3NvID0gQWdncmVnYXRlRXhwcmVzc2lvbihnZW9fc28sIGFzc2F5cyA9ICdSTkEnLCByZXR1cm4uc2V1cmF0ID0gVFJVRSwgZ3JvdXAuYnkgPSBjKCdjZWxsX3R5cGUnLCAnZGF5JywgJ3JlcGxpY2F0ZScpKQoKIyBTZXQgdXAgbGFiZWxzIHRvIHVzZSBmb3IgY29tcGFyaXNvbnMgJiBhc3NpZ24gYXMgY2VsbCBpZGVudGl0aWVzCnBzZXVkb19jYXRjaF9zbyRkYXkuY2VsbHR5cGUgPSBwYXN0ZShwc2V1ZG9fY2F0Y2hfc28kZGF5LCBwc2V1ZG9fY2F0Y2hfc28kY2VsbF90eXBlLCBzZXAgPSAnXycpCklkZW50cyhwc2V1ZG9fY2F0Y2hfc28pID0gJ2RheS5jZWxsdHlwZScKCiMgUnVuIHBzZXVkb2J1bGsgY29tcGFyaXNvbiBiZXR3ZWVuIERheSAyMSBhbmQgRGF5IDAsIHVzaW5nIERFU2VxMgpkZV9wc2V1ZG9fcGVyaWN5dGVfRDIxX3ZzX0Q3ID0gRmluZE1hcmtlcnMoCiAgICBvYmplY3QgPSBwc2V1ZG9fY2F0Y2hfc28sIAogICAgaWRlbnQuMSA9ICdEYXkyMV9QZXJpY3l0ZScsIGlkZW50LjIgPSAnRGF5N19QZXJpY3l0ZScsIAogICAgdGVzdC51c2UgPSAnREVTZXEyJykKCiMgVGFrZSBhIGxvb2sgYXQgdGhlIHRhYmxlCmhlYWQoZGVfcHNldWRvX3BlcmljeXRlX0QyMV92c19ENykKCiMgQWRkIHJvd25hbWVzIGFzIGEgY29sdW1uIGZvciBvdXRwdXQKZGVfcHNldWRvX3BlcmljeXRlX0QyMV92c19ENyRnZW5lID0gcm93bmFtZXMoZGVfcHNldWRvX3BlcmljeXRlX0QyMV92c19ENykKCiMgbG9vayBhdCByZXN1bHRzLCB1c2luZyB0aGUgc2FtZSB0aHJlc2hvbGRzCnRhYmxlKGRlX3BzZXVkb19wZXJpY3l0ZV9EMjFfdnNfRDckcF92YWxfYWRqIDwgMC4wNSAmIGFicyhkZV9wc2V1ZG9fcGVyaWN5dGVfRDIxX3ZzX0Q3JGF2Z19sb2cyRkMpID4gMS41KQoKIyBvdXRwdXQgcmVzdWx0cwp3cml0ZV9jc3YoZGVfcHNldWRvX3BlcmljeXRlX0QyMV92c19ENywgZmlsZSA9ICdyZXN1bHRzL3RhYmxlcy9kZV9wc2V1ZG9fcGVyaWN5dGVfRDIxX3ZzX0Q3LmNzdicpCmBgYAoKClNpbmNlIHdlJ3JlIHdvcmtpbmcgd2l0aCBwc2V1ZG9idWxrIGRhdGEsIHVubGlrZSBpbiB0aGUgbWFya2VyIGlkZW50aWZpY2F0aW9uIHNlY3Rpb24sIHRoZXJlIGlzIG5vIHBlcmNlbnRhZ2Ugb2YgY2VsbHMgZXhwcmVzc2luZyB0byBuZWVkIHRvIHJlcHJlc2VudCBzbyB3ZSBjYW4gc3VtbWFyaXplIG91ciBERSByZXN1bHRzIHdpdGggYSB2b2xjYW5vIHBsb3Q6CgpgYGB7ciwgZGVfcHNldWRvYnVsa192b2xjYW5vLCB3YXJuaW5nID0gRkFMU0UsIG1lc3NhZ2UgPSBGQUxTRX0KcHNldWRvX3BlcmljeXRlX0QyMV92c19EN192b2xjYW5vID0gZ2dwbG90KGRlX3BzZXVkb19wZXJpY3l0ZV9EMjFfdnNfRDcsIGFlcyh4ID0gYXZnX2xvZzJGQywgeSA9IC1sb2cxMChwX3ZhbCkpKSArIGdlb21fcG9pbnQoKQpwc2V1ZG9fcGVyaWN5dGVfRDIxX3ZzX0Q3X3ZvbGNhbm8KCmdnc2F2ZShmaWxlbmFtZSA9ICdyZXN1bHRzL2ZpZ3VyZXMvdm9sY2Fub19kZV9wc2V1ZG9fcGVyaWN5dGVfRDIxX3ZzX0QwLnBuZycsIHBsb3QgPSBwc2V1ZG9fcGVyaWN5dGVfRDIxX3ZzX0Q3X3ZvbGNhbm8sIHdpZHRoID0gNywgaGVpZ2h0ID0gNywgdW5pdHMgPSAnaW4nKQpgYGAKPCEtLS0gCiMjIyBJdGVyYXRpbmcgb3ZlciBhbGwgY2x1c3RlcnMKCkFkZCBjb2RlIHRvIGdlbmVyYXRlIHBzZXVkb2J1bGsgcmVzdWx0cyBmb3IgZWFjaCBjbHVzdGVyIGZvciBhbGwgRGF5IDcgdnMgRGF5IDIxIGNvbXBhcmlzb25zCi0tLT4KCiMjIyBGdXJ0aGVyIGV4YW1pbmluZyBERSByZXN1bHRzCgpXZSBjYW4gYWxzbyBvdmVybGF5IHRoZSBleHByZXNzaW9uIG9mIGludGVyZXN0aW5nIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBnZW5lcyBiYWNrIG9udG8gb3VyIFVNQVAgcGxvdHMgdG8gaGlnaGxpZ2h0IHRoZSBsb2NhbGl6YXRpb24gYW5kIHBvc3NpYmxlIGZ1bmN0aW9uLCBhZ2FpbiB1c2luZyB0aGUgYEZlYXR1cmVQbG90YCBmdW5jdGlvbi4gCgpgYGB7ciwgc2hvd19ERV9mZWF0dXJlUGxvdCwgd2FybmluZyA9IEZBTFNFLCBtZXNzYWdlID0gRkFMU0V9CkZlYXR1cmVQbG90KGdlb19zbywgZmVhdHVyZXMgPSAiQ2Q1NSIsIHNwbGl0LmJ5ID0gImRheSIpCmBgYApTbyB3ZSBmb3VuZCBDZDU1IGJhc2VkIG9uIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGNvbXBhcmlzb24gaW4gdGhlIFBlcmljeXRlIHBvcHVsYXRpb24gYmV0d2VlbiBEYXkgNyBhbmQgRGF5IDIxIGJ1dCBpbiBsb29raW5nIGF0IHRoZSBGZWF0dXJlIHBsb3Qgb2YgZXhwcmVzc2lvbiwgd2UgYWxzbyBzZWUgaGlnaCBleHByZXNzaW9uIGluIGEgc3Vic2V0IG9mIGNlbGxzIG9uIERheSAwLiBUaGlzIGludGVyZXN0aW5nLCBzaW5jZSBhY2NvcmRpbmcgdG8gW1NoaW4gZXQgYWwgKDIwMTkpXShodHRwczovL29ubGluZWxpYnJhcnkud2lsZXkuY29tL2RvaS9mdWxsLzEwLjEwMDIvamJtci4zODYxKSwgQ0Q1NSByZWd1bGF0ZXMgYm9uZSBtYXNzIGluIG1pY2UuCgpJdCBhbHNvIGxvb2tzIGxpa2UgdGhlcmUgaXMgYSBoaWdoIHBlcmNlbnRhZ2Ugb2YgZXhwcmVzc2lvbiBpbiBhIHN1YnBvcHVsYXRpb24gb2YgdGhlIG90aGVyIHR3byBwcmVjdXJzb3Ivc3RlbSBjZWxsIHBvcHVsYXRpb25zIG9uIHRoZSB0b3AgcmlnaHQgb2Ygb3VyIHBsb3RzLCB3aGljaCBpcyBpbnRlcmVzdGluZyBhbmQgbWlnaHQgc3VnZ2VzdCBhbiBpbnRlcmVzdGluZyBzdWJwb3B1bGF0aW9uIHRoYXQgd2UgbWlnaHQgdHJ5IHRvIGlkZW50aWZ5LCBwYXJ0aWN1bGFybHkgZ2l2ZW4gdGhlIHJvbGUgb2YgdGhpcyBnZW5lIGFuZCBvdXIgaW50ZXJlc3QgaW4gZGV0ZXJtaW5pbmcgd2h5IGFiYmVyYW50IGJvbmUgY2FuIGZvcm0gYWZ0ZXIgaW5qdXJ5LgoKIyMgTmV4dCBzdGVwcyAKCldoaWxlIGxvb2tpbmcgYXQgaW5kaXZpZHVhbCBnZW5lcyBjYW4gcmV2ZWFsIGludGVyZXN0aW5nIHBhdHRlcm5zIGxpa2UgaW4gdGhlIGNhc2Ugb2YgQ2Q1NSwgaXQncyBub3QgYSB2ZXJ5IGVmZmljaWVudCBwcm9jZXNzLiBTbyBhZnRlciBydW5uaW5nICdzdGFuZGFyZCcgYW5kL29yIHBzdWVkb2J1bGsgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gY29tcGFyaXNvbnMsIHdlIGNhbiB1c2UgdGhlIHNhbWUgdHlwZXMgb2YgdG9vbHMgdXNlZCBkb3duc3RyZWFtIG9mIGJ1bGsgUk5BLXNlcSB0byBpbnRlcnByZXQgdGhlc2UgcmVzdWx0cywgc3VjaCBhcyBHTyB0ZXJtIGVucmljaG1lbnQsIEtFR0cgcGF0aHdheSBlbnJpY2htZW50LCBhbmQgR1NFQSB3aXRoIG1TaWdEQi4gCgoKIyBTYXZlIG91ciBwcm9ncmVzcwoKV2UnbGwgc2F2ZSB0aGUgc2NDQVRDSCBvYmplY3QuIFRoZSBTZXVyYXQgb2JqZWN0IGhhcyBub3QgYmVlbiBjaGFuZ2VkIGluIHRoaXMgbW9kdWxlLgoKYGBge3IsIHNhdmVfcmRzX2hpZGRlbiwgZWNobyA9IEZBTFNFfQppZighZmlsZS5leGlzdHMoJ3Jlc3VsdHMvcmRhdGEvZ2VvX3NvX3NjdF9pbnRlZ3JhdGVkX3dpdGhfZmluYWwucmRzJykpIHsKICBzYXZlUkRTKGdlb19zbywgZmlsZSA9ICdyZXN1bHRzL3JkYXRhL2dlb19zb19zY3RfaW50ZWdyYXRlZF9maW5hbC5yZHMnKQp9CmBgYAoKYGBge3IsIHNhdmVfcmRzLCBldmFsPUZBTFNFfQpzYXZlUkRTKGdlb19zbywgZmlsZSA9ICdyZXN1bHRzL3JkYXRhL2dlb19zb19zY3RfaW50ZWdyYXRlZF9maW5hbC5yZHMnKQpgYGAKCi0tLQoKIyBEb3duc3RyZWFtIGFwcHJvYWNoZXMKCkJleW9uZCBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiB3aXRoaW4gY2x1c3RlcnMgYW5kICwgdGhlcmUgYXJlIG1hbnkgb3RoZXIgcG9zc2libGUgYXZlbnVlcyBvZiBleHBsb3JhdGlvbiBhbmQgYW5hbHlzaXMgZm9yIHNjUk5BLXNlcSBkYXRhLiBJbmNsdWRpbmcsIGJ1dCBub3QgbGltaXRlZCB0bzoKCi0gSW50ZWdyYXRpb24gd2l0aCBvdGhlciBtb2RhbGl0aWVzIChlLmcuIEFUQUMtc2VxLCBWREosIGV0Yy4pCgotIFN1YmNsdXN0ZXJpbmcgY2x1c3RlcnMgb2YgaW50ZXJlc3QsIHNlZSBbSEJDJ3Mgc3VtbWFyeSBvbiBzdWJjbHVzdGVyaW5nXShodHRwczovL2hiY3RyYWluaW5nLmdpdGh1Yi5pby9zY1JOQS1zZXFfb25saW5lL2xlc3NvbnMvc2V1cmF0X3N1YmNsdXN0ZXJpbmcuaHRtbCksIFtTZXVyYXQncyBmaW5kU3ViY0NsdXN0ZXIgZG9jdW1lbnRhdGlvbl0oaHR0cHM6Ly9zYXRpamFsYWIub3JnL3NldXJhdC9yZWZlcmVuY2UvZmluZHN1YmNsdXN0ZXIpIGFuZCBbdGhpcyByZWxhdGVkIGlzc3VlIHRocmVhZF0oaHR0cHM6Ly9naXRodWIuY29tL3NhdGlqYWxhYi9zZXVyYXQvaXNzdWVzLzE4ODMpICAKCi0gVHJhamVjdG9yeSBvciBQc2V1ZG90aW1lIGFuYWx5c2lzLCBzZWVbT3V5YW5nIExhYidzIHRyYWplY3RvcnkgYW5hbHlzaXNdKGh0dHBzOi8vb3V5YW5nbGFiLmNvbS9zaW5nbGVjZWxsL2RpbXJkLmh0bWwpIG9yIFtCcm9hZCBJbnN0aXR1dGUncyBtYXRlcmlhbHMgb24gdHJhamVjdG9yeSBhbmFseXNpc10oaHR0cHM6Ly9icm9hZGluc3RpdHV0ZS5naXRodWIuaW8vMjAyMF9zY1dvcmtzaG9wL3RyYWplY3RvcnktYW5hbHlzaXMuaHRtbCksIGFtb25nIG90aGVyIHJlc291cmNlcyAgICAKCi0gQ2VsbCAtIENlbGwgY29tbXVuaWNhdGlvbiBuZXR3b3JrIGluZmVyZW5jZSwgc2VlIFtyZXZpZXcgYnkgV2lsayBldCBhbCAoMjAyMyldKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvczQxNTg3LTAyMy0wMTc4Mi16KQoKLSBWZWxvY2l0eSBhbmFseXNpcyAobm90ZTogbm90IGNvbXBhdGlibGUgd2l0aCB0aGUgZmxleCBwcm9iZSBiYXNlZCBraXRzKSwgc2VlIFt0aGUgY2hhcHRlciBmcm9tIHRoZSBzaW5nbGUtY2VsbHMgYmVzdCBwcmFjdGljZXMgYm9va10oaHR0cHM6Ly93d3cuc2MtYmVzdC1wcmFjdGljZXMub3JnL3RyYWplY3Rvcmllcy9ybmFfdmVsb2NpdHkuaHRtbCkgZm9yIGRldGFpbGVkIHRoZW9yeS9tb2RlbGluZyBvciB0aGUgWzEweCBkYXRhIHZpZ25ldHRlIGZvciB2ZWxvY3l0b10oaHR0cHM6Ly9wa2xhYi5tZWQuaGFydmFyZC5lZHUvdmVsb2N5dG8vbm90ZWJvb2tzL1IvU0NHNzEubmIuaHRtbCkgZm9yIGEgcHJhY3RpY2FsIGV4YW1wbGUgaW4gUgoKV2Ugd291bGQgcmVjb21tZW5kIGxvb2tpbmcgZm9yIHN0dWRpZXMgaW4gc2ltaWxhciB0aXNzdWVzIG9yIGV4cGVyaW1lbnRhbCBxdWVzdGlvbnMgYW5kIHNlZSB3aGF0IGtpbmQgb2YgYXBwcm9hY2hlcyBhbmQgdG9vbHMgd2VyZSB1c2VkIHRvIGFuc3dlciBxdWVzdGlvbnMgcmVsYXRlZCB0byB5b3VyIGJpb2xvZ2ljYWwgcXVlc3Rpb24KCiMgU3VtbWFyeQoKUmV2aWV3aW5nIHRoZXNlIHJlc3VsdHMgc2hvdWxkIGFsbG93IHVzIHRvIGlkZW50aWZ5IGdlbmVzIG9mIGludGVyZXN0IHRoYXQgYXJlIGltcGFjdGVkIGJ5IGluanVyeSBhbmQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGNlbGwtdHlwZXMgaW4gd2hpY2ggdGhleSBhcmUgZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkLCBmb3JtYWxpemUgc29tZSBoeXBvdGhlc2VzIGZvciB3aGF0IGNlbGwtdHlwZXMgb3IgYmlvbG9naWNhbCBwcm9jZXNzZXMgbWlnaHQgYmUgY29udHJpYnV0aW5nIHRvIGFiZXJyYW50IGJvbmUgZm9ybWF0aW9uLiAKCi0tLS0KClRoZXNlIG1hdGVyaWFscyBoYXZlIGJlZW4gYWRhcHRlZCBhbmQgZXh0ZW5kZWQgZnJvbSBtYXRlcmlhbHMgbGlzdGVkIGFib3ZlLiBUaGVzZSBhcmUgb3BlbiBhY2Nlc3MgbWF0ZXJpYWxzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgW0NyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24gbGljZW5zZSAoQ0MgQlkgNC4wKV0oaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvNC4wLyksIHdoaWNoIHBlcm1pdHMgdW5yZXN0cmljdGVkIHVzZSwgZGlzdHJpYnV0aW9uLCBhbmQgcmVwcm9kdWN0aW9uIGluIGFueSBtZWRpdW0sIHByb3ZpZGVkIHRoZSBvcmlnaW5hbCBhdXRob3IgYW5kIHNvdXJjZSBhcmUgY3JlZGl0ZWQuCgo8YnIvPgo8YnIvPgo8aHIvPgp8IFtQcmV2aW91cyBsZXNzb25dKDA3LUNlbGxUeXBlQW5ub3MuaHRtbCkgfCBbVG9wIG9mIHRoaXMgbGVzc29uXSgjdG9wKSB8IFtXb3Jrc2hvcCBXcmFwIFVwXSh3b3Jrc2hvcF93cmFwX3VwLmh0bWwpIHwKfCA6LS0tIHwgOi0tLS06IHwgLS0tOiB8Cg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("08-DifferentialExpression.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
