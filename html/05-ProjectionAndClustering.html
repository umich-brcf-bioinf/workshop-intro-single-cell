<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2024-02-21" />

<title>Clustering and Projection</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<!--
Favicon dervied from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="shortcut icon" href="favicon-16x16.png" />
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to scRNA-Seq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="workshop_intro.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00A-OrientingOnScRNASeq.html">Orienting on scRNA-Seq</a>
    </li>
    <li>
      <a href="00B-CellRangerInAction.html">Cell Ranger in Action</a>
    </li>
    <li>
      <a href="01-GettingStarted.html">Seurat</a>
    </li>
    <li>
      <a href="02-QCandFiltering.html">Secondary QC &amp; Filtering</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03-Integration.html">Normalization</a>
    </li>
    <li>
      <a href="04-PCAandDimReduction.html">PCA &amp; Integration</a>
    </li>
    <li>
      <a href="05-ProjectionAndClustering.html">Projection &amp; Clustering</a>
    </li>
    <li>
      <a href="06-MarkerVisualization.html">Marker identification and visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07-CellTypeAnnos.html">Cell type annotation</a>
    </li>
    <li>
      <a href="08-DifferentialExpression.html">Differential expression analysis</a>
    </li>
    <li>
      <a href="09-IndependentExercise.html">Independent exercise</a>
    </li>
  </ul>
</li>
<li>
  <a href="workshop_wrap_up.html">Wrap up</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Clustering and Projection</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2024-02-21</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<div id="workflow-overview" class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Workflow Overview</h1>
<p><br/>
<img src="images/wayfinder/wayfinder.png" alt="wayfinder" style="height: 400px;"/>
<br/> <br/></p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<!--Add specific goals for section-->
<p>Point out possible gaps between how single-cell data is presented
versus the reality of running an analysis E.g. Papers might report final
filtering thresholds, but our process for choosing those is likely to be
more iterative</p>
<p>General goal: Filtering out the “cells” that either were poorly
measured or are either not single-cells or not cells at all</p>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<ul>
<li>XX</li>
<li>XX</li>
</ul>
<hr />
</div>
</div>
<div id="projection-and-clustering" class="section level1">
<h1>Projection and clustering</h1>
<p>Contrast the previous dimensionality reduction/nearest neighbors
clustering and plotting the cells in lower dimensionality with the
cluster labels.</p>
<div id="clustering" class="section level2">
<h2>Clustering</h2>
<p>Nearest neighbors algorithm - based on similarity of expression
pattern (just for genes/PCs selected)</p>
<p>Again, how are you defining a “cell type” or “subtype” should help
with ambiguity not only with “How do I decide how many PCs to include?”
but also “How do I choose a resolution for finding clusters?” (as well
as evaluating in the downstream if your initial choices should be
revised).</p>
<!-- per Ho Lab - The previous version of Seurat (v3) applied a graph-based clustering approach, building upon initial strategies in the development of the initial droplet based single cell technology([Macosko et al. 2015](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4481139/)). "Importantly, the distance metric which drives the clustering analysis (based on previously identified PCs) remains the same."

"However, approach in Seurat to partitioning the cellular distance matrix into clusters has dramatically improved. This approach was heavily inspired by recent publications which applied graph-based clustering approaches to scRNA-seq data ([Xu and Su 2015](https://academic.oup.com/bioinformatics/article/31/12/1974/214505)) and CyTOF data ([Levine et al. 2015](https://www.cell.com/cell/pdfExtended/S0092-8674(15)00637-6)). Briefly, these methods embed cells in a graph structure - for example a K-nearest neighbor (KNN) graph, with edges drawn between cells with similar feature expression patterns, and then attempt to partition this graph into highly interconnected ‘quasi-cliques’ or ‘communities’." -->
<pre class="r"><code>geo_so = FindNeighbors(geo_so, dims = 1:25, reduction = &#39;integrated.sct.cca&#39;)</code></pre>
<pre class="r"><code>geo_so = FindClusters(geo_so, resolution = 1, cluster.name = &#39;integrated.sct.cca.clusters&#39;)</code></pre>
<pre class="r"><code>head(Indets(geo_so), 5)</code></pre>
<pre><code># add expected output</code></pre>
</div>
</div>
<div id="cluster-plots" class="section level1">
<h1>Cluster plots</h1>
<p>Note how dimensionality choices are carried through downstream
functions.</p>
<p>What’s different beteween PCA, tSNE, and UMAP?</p>
<p>Note: tSNE vs UMAP example: <a
href="https://pair-code.github.io/understanding-umap/"
class="uri">https://pair-code.github.io/understanding-umap/</a></p>
<pre class="r"><code>geo_so = RunUMAP(geo_so, dims = 1:25, reduction = &#39;unintegrated.sct.pca&#39;, reduction.name = &#39;umap.unintegrated.sct.pca&#39;)</code></pre>
</div>
<div id="visualizing-and-evaluating-clustering" class="section level1">
<h1>Visualizing and evaluating clustering</h1>
<p>How many clusters should I get and how do I adjust the number?</p>
<!--- Show example of changing resolution?--->
<p>We can check the how well the normalization and integration .</p>
<pre class="r"><code>post_integration_umap_plot_day = DimPlot(geo_so, group.by = &#39;day&#39;, label = FALSE, reduction = &#39;umap.sct.integrated.cca&#39;) + NoLegend()
ggsave(filename = &#39;ISC_R/results/figures/umap_integrated_sct_day.png&#39;, plot = post_integration_umap_plot_day)</code></pre>
<p><img src="images/curriculum/umap_integrated_sct_day.png" /></p>
<pre class="r"><code>post_integration_umap_plot_orig.ident = DimPlot(geo_so, group.by = &#39;orig.ident&#39;, label = FALSE, reduction = &#39;umap.sct.integrated.cca&#39;) + NoLegend()
ggsave(filename = &#39;ISC_R/results/figures/umap_integrated_sct_orig.ident.png&#39;, plot = post_integration_umap_plot_orig.ident)</code></pre>
<p><img
src="images/curriculum/umap_integrated_sct_orig.ident.png" /></p>
<p>We can also evaluate cluster membership by <code>orig.ident</code> or
by <code>day</code> using the <code>table()</code> function:</p>
<pre class="r"><code>table(geo_so@meta.data$orig.ident, geo_so@meta.data$integrated.sct.cca.clusters)</code></pre>
</div>
<div id="other-approaches-for-visualizing-scrna-sq-data"
class="section level1">
<h1>Other approaches for visualizing scRNA-sq data</h1>
<p>tSNE, PCA</p>
</div>
<div id="comparing-to-unintegrated-data" class="section level1">
<h1>Comparing to unintegrated data</h1>
<p>If we had proceeded with our filtered data and only normalized our
data without doing any integration, including through the dimensionality
reduction and clustering steps and then labeled the cells with their
sample of origin, then we would see the following for our data:</p>
<!--Add example of UMAP / sample labels for unintegrated data from analysis folder to images-->
<p><img src="umap_comparison_sct.png" /></p>
<p>In this plot, we … see that while there are distinct clusters, those
clusters seem to separate primarily by sample id. This suggests that
without integration, these batch effects could skew the biological
variability in our data.
<!--move this section to end of Projection module to contrast with integrated results--></p>
<!-- Edit section to incorporate --->
</div>
<div id="rewind-pre-integration-evaluation" class="section level1">
<h1>Rewind: Pre-integration evaluation</h1>
<p>Prior to integration, we would like to know if there are any batch
effects that carry through to the cell clusters. Most importantly, we
would like to know if clusters tend to be determined by sample or
condition (in this case, the day). In order to figure this out we have
already run the following three commands, which we will describe in more
detail later.</p>
<pre class="r"><code># DefaultAssay(geo_so) = &#39;RNA&#39;

geo_so = RunPCA(geo_so, reduction.name = &#39;unintegrated.sct.pca&#39;)
geo_so = FindNeighbors(geo_so, dims = 1:25, reduction = &#39;unintegrated.sct.pca&#39;)
geo_so = FindClusters(geo_so, resolution = 0.5, cluster.name = &#39;unintegrated.sct.clusters&#39;)
geo_so = RunUMAP(geo_so, dims = 1:25, reduction = &#39;unintegrated.sct.pca&#39;, reduction.name = &#39;umap.unintegrated.sct.pca&#39;)</code></pre>
<p>From this image, we can qualitatively see that some clusters seem to
be driven by the original identity. We can see this even more clearly if
we use <code>group.by = 'day'</code>:</p>
<pre class="r"><code>pre_integration_umap_plot = DimPlot(geo_so, group.by = &#39;day&#39;, label = FALSE, reduction = &#39;umap.unintegrated.sct.pca&#39;) + NoLegend()
ggsave(filename = &#39;ISC_R/results/figures/umap_unintegrated_sct_day.png&#39;, plot = pre_integration_umap_plot)</code></pre>
<p><img src="images/curriculum/umap_unintegrated_sct_day.png" /></p>
<!-- Make sure above section is edited -->
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Now that we have …</p>
<p>Next steps: Marker genes</p>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="04-PCAandDimReduction.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a href="06-MarkerVisualization.html">Next
lesson</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQ2x1c3RlcmluZyBhbmQgUHJvamVjdGlvbiIKYXV0aG9yOiAiVU0gQmlvaW5mb3JtYXRpY3MgQ29yZSIKZGF0ZTogImByIFN5cy5EYXRlKClgIgpvdXRwdXQ6CiAgICAgICAgaHRtbF9kb2N1bWVudDoKICAgICAgICAgICAgaW5jbHVkZXM6CiAgICAgICAgICAgICAgICBpbl9oZWFkZXI6IGhlYWRlci5odG1sCiAgICAgICAgICAgIHRoZW1lOiBwYXBlcgogICAgICAgICAgICB0b2M6IHRydWUKICAgICAgICAgICAgdG9jX2RlcHRoOiA0CiAgICAgICAgICAgIHRvY19mbG9hdDogdHJ1ZQogICAgICAgICAgICBudW1iZXJfc2VjdGlvbnM6IGZhbHNlCiAgICAgICAgICAgIGZpZ19jYXB0aW9uOiB0cnVlCiAgICAgICAgICAgIG1hcmtkb3duOiBHRk0KICAgICAgICAgICAgY29kZV9kb3dubG9hZDogdHJ1ZQotLS0KCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CmJvZHksIHRkIHsKICAgZm9udC1zaXplOiAxOHB4Owp9CmNvZGUucnsKICBmb250LXNpemU6IDEycHg7Cn0KcHJlIHsKICBmb250LXNpemU6IDEycHgKfQo8L3N0eWxlPgoKYGBge3IsIGluY2x1ZGUgPSBGQUxTRX0Kc291cmNlKCIuLi9iaW4vY2h1bmstb3B0aW9ucy5SIikKa25pdHJfZmlnX3BhdGgoIlhYIikKYGBgCgojIFdvcmtmbG93IE92ZXJ2aWV3IHsudW5saXN0ZWQgLnVubnVtYmVyZWR9Cgo8YnIvPgo8aW1nIHNyYz0iaW1hZ2VzL3dheWZpbmRlci93YXlmaW5kZXIucG5nIiBhbHQ9IndheWZpbmRlciIgc3R5bGU9ImhlaWdodDogNDAwcHg7Ii8+Cjxici8+Cjxici8+CgojIEludHJvZHVjdGlvbgoKPCEtLUFkZCBzcGVjaWZpYyBnb2FscyBmb3Igc2VjdGlvbi0tPgoKUG9pbnQgb3V0IHBvc3NpYmxlIGdhcHMgYmV0d2VlbiBob3cgc2luZ2xlLWNlbGwgZGF0YSBpcyBwcmVzZW50ZWQgdmVyc3VzIHRoZSByZWFsaXR5IG9mIHJ1bm5pbmcgYW4gYW5hbHlzaXMKRS5nLiBQYXBlcnMgbWlnaHQgcmVwb3J0IGZpbmFsIGZpbHRlcmluZyB0aHJlc2hvbGRzLCBidXQgb3VyIHByb2Nlc3MgZm9yIGNob29zaW5nIHRob3NlIGlzIGxpa2VseSB0byBiZSBtb3JlIGl0ZXJhdGl2ZQoKR2VuZXJhbCBnb2FsOiBGaWx0ZXJpbmcgb3V0IHRoZSAiY2VsbHMiIHRoYXQgZWl0aGVyIHdlcmUgcG9vcmx5IG1lYXN1cmVkIG9yIGFyZSBlaXRoZXIgbm90IHNpbmdsZS1jZWxscyBvciBub3QgY2VsbHMgYXQgYWxsCgojIyBPYmplY3RpdmVzCgotIFhYCi0gWFgKCi0tLQoKCiMgUHJvamVjdGlvbiBhbmQgY2x1c3RlcmluZwoKQ29udHJhc3QgdGhlIHByZXZpb3VzIGRpbWVuc2lvbmFsaXR5IHJlZHVjdGlvbi9uZWFyZXN0IG5laWdoYm9ycyBjbHVzdGVyaW5nIGFuZCBwbG90dGluZyB0aGUgY2VsbHMgaW4gbG93ZXIgZGltZW5zaW9uYWxpdHkgd2l0aCB0aGUgY2x1c3RlciBsYWJlbHMuCgoKIyMgQ2x1c3RlcmluZwoKTmVhcmVzdCBuZWlnaGJvcnMgYWxnb3JpdGhtIC0gYmFzZWQgb24gc2ltaWxhcml0eSBvZiBleHByZXNzaW9uIHBhdHRlcm4gKGp1c3QgZm9yIGdlbmVzL1BDcyBzZWxlY3RlZCkKCkFnYWluLCBob3cgYXJlIHlvdSBkZWZpbmluZyBhIOKAnGNlbGwgdHlwZeKAnSBvciDigJxzdWJ0eXBl4oCdIHNob3VsZCBoZWxwIHdpdGggYW1iaWd1aXR5IG5vdCBvbmx5IHdpdGggIkhvdyBkbyBJIGRlY2lkZSBob3cgbWFueSBQQ3MgdG8gaW5jbHVkZT8iIGJ1dCBhbHNvICJIb3cgZG8gSSBjaG9vc2UgYSByZXNvbHV0aW9uIGZvciBmaW5kaW5nIGNsdXN0ZXJzPyIgKGFzIHdlbGwgYXMgZXZhbHVhdGluZyBpbiB0aGUgZG93bnN0cmVhbSBpZiB5b3VyIGluaXRpYWwgY2hvaWNlcyBzaG91bGQgYmUgcmV2aXNlZCkuCgoKPCEtLSBwZXIgSG8gTGFiIC0gVGhlIHByZXZpb3VzIHZlcnNpb24gb2YgU2V1cmF0ICh2MykgYXBwbGllZCBhIGdyYXBoLWJhc2VkIGNsdXN0ZXJpbmcgYXBwcm9hY2gsIGJ1aWxkaW5nIHVwb24gaW5pdGlhbCBzdHJhdGVnaWVzIGluIHRoZSBkZXZlbG9wbWVudCBvZiB0aGUgaW5pdGlhbCBkcm9wbGV0IGJhc2VkIHNpbmdsZSBjZWxsIHRlY2hub2xvZ3koW01hY29za28gZXQgYWwuIDIwMTVdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzQ0ODExMzkvKSkuICJJbXBvcnRhbnRseSwgdGhlIGRpc3RhbmNlIG1ldHJpYyB3aGljaCBkcml2ZXMgdGhlIGNsdXN0ZXJpbmcgYW5hbHlzaXMgKGJhc2VkIG9uIHByZXZpb3VzbHkgaWRlbnRpZmllZCBQQ3MpIHJlbWFpbnMgdGhlIHNhbWUuIgoKIkhvd2V2ZXIsIGFwcHJvYWNoIGluIFNldXJhdCB0byBwYXJ0aXRpb25pbmcgdGhlIGNlbGx1bGFyIGRpc3RhbmNlIG1hdHJpeCBpbnRvIGNsdXN0ZXJzIGhhcyBkcmFtYXRpY2FsbHkgaW1wcm92ZWQuIFRoaXMgYXBwcm9hY2ggd2FzIGhlYXZpbHkgaW5zcGlyZWQgYnkgcmVjZW50IHB1YmxpY2F0aW9ucyB3aGljaCBhcHBsaWVkIGdyYXBoLWJhc2VkIGNsdXN0ZXJpbmcgYXBwcm9hY2hlcyB0byBzY1JOQS1zZXEgZGF0YSAoW1h1IGFuZCBTdSAyMDE1XShodHRwczovL2FjYWRlbWljLm91cC5jb20vYmlvaW5mb3JtYXRpY3MvYXJ0aWNsZS8zMS8xMi8xOTc0LzIxNDUwNSkpIGFuZCBDeVRPRiBkYXRhIChbTGV2aW5lIGV0IGFsLiAyMDE1XShodHRwczovL3d3dy5jZWxsLmNvbS9jZWxsL3BkZkV4dGVuZGVkL1MwMDkyLTg2NzQoMTUpMDA2MzctNikpLiBCcmllZmx5LCB0aGVzZSBtZXRob2RzIGVtYmVkIGNlbGxzIGluIGEgZ3JhcGggc3RydWN0dXJlIC0gZm9yIGV4YW1wbGUgYSBLLW5lYXJlc3QgbmVpZ2hib3IgKEtOTikgZ3JhcGgsIHdpdGggZWRnZXMgZHJhd24gYmV0d2VlbiBjZWxscyB3aXRoIHNpbWlsYXIgZmVhdHVyZSBleHByZXNzaW9uIHBhdHRlcm5zLCBhbmQgdGhlbiBhdHRlbXB0IHRvIHBhcnRpdGlvbiB0aGlzIGdyYXBoIGludG8gaGlnaGx5IGludGVyY29ubmVjdGVkIOKAmHF1YXNpLWNsaXF1ZXPigJkgb3Ig4oCYY29tbXVuaXRpZXPigJkuIiAtLT4KCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpnZW9fc28gPSBGaW5kTmVpZ2hib3JzKGdlb19zbywgZGltcyA9IDE6MjUsIHJlZHVjdGlvbiA9ICdpbnRlZ3JhdGVkLnNjdC5jY2EnKQpgYGAKCmBgYHtyLCBldmFsPUZBTFNFfQpnZW9fc28gPSBGaW5kQ2x1c3RlcnMoZ2VvX3NvLCByZXNvbHV0aW9uID0gMSwgY2x1c3Rlci5uYW1lID0gJ2ludGVncmF0ZWQuc2N0LmNjYS5jbHVzdGVycycpCmBgYAoKYGBge3IsIGV2YWw9RkFMU0V9CmhlYWQoSW5kZXRzKGdlb19zbyksIDUpCmBgYAoKfn5+CiMgYWRkIGV4cGVjdGVkIG91dHB1dAp+fn4KCgojIENsdXN0ZXIgcGxvdHMKCk5vdGUgaG93IGRpbWVuc2lvbmFsaXR5IGNob2ljZXMgYXJlIGNhcnJpZWQgdGhyb3VnaCBkb3duc3RyZWFtIGZ1bmN0aW9ucy4KCldoYXQncyBkaWZmZXJlbnQgYmV0ZXdlZW4gUENBLCB0U05FLCBhbmQgVU1BUD8KCk5vdGU6IHRTTkUgdnMgVU1BUCBleGFtcGxlOiBodHRwczovL3BhaXItY29kZS5naXRodWIuaW8vdW5kZXJzdGFuZGluZy11bWFwLyAKCmBgYHtyLCBldmFsPUZBTFNFfQpnZW9fc28gPSBSdW5VTUFQKGdlb19zbywgZGltcyA9IDE6MjUsIHJlZHVjdGlvbiA9ICd1bmludGVncmF0ZWQuc2N0LnBjYScsIHJlZHVjdGlvbi5uYW1lID0gJ3VtYXAudW5pbnRlZ3JhdGVkLnNjdC5wY2EnKQpgYGAKCiMgVmlzdWFsaXppbmcgYW5kIGV2YWx1YXRpbmcgY2x1c3RlcmluZwoKSG93IG1hbnkgY2x1c3RlcnMgc2hvdWxkIEkgZ2V0IGFuZCBob3cgZG8gSSBhZGp1c3QgdGhlIG51bWJlcj8KCjwhLS0tIFNob3cgZXhhbXBsZSBvZiBjaGFuZ2luZyByZXNvbHV0aW9uPy0tLT4KCgpXZSBjYW4gY2hlY2sgdGhlIGhvdyB3ZWxsIHRoZSBub3JtYWxpemF0aW9uIGFuZCBpbnRlZ3JhdGlvbiAuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpwb3N0X2ludGVncmF0aW9uX3VtYXBfcGxvdF9kYXkgPSBEaW1QbG90KGdlb19zbywgZ3JvdXAuYnkgPSAnZGF5JywgbGFiZWwgPSBGQUxTRSwgcmVkdWN0aW9uID0gJ3VtYXAuc2N0LmludGVncmF0ZWQuY2NhJykgKyBOb0xlZ2VuZCgpCmdnc2F2ZShmaWxlbmFtZSA9ICdJU0NfUi9yZXN1bHRzL2ZpZ3VyZXMvdW1hcF9pbnRlZ3JhdGVkX3NjdF9kYXkucG5nJywgcGxvdCA9IHBvc3RfaW50ZWdyYXRpb25fdW1hcF9wbG90X2RheSkKYGBgCgohW10oLi9pbWFnZXMvY3VycmljdWx1bS91bWFwX2ludGVncmF0ZWRfc2N0X2RheS5wbmcpCgoKCmBgYHtyLCBldmFsID0gRkFMU0V9CnBvc3RfaW50ZWdyYXRpb25fdW1hcF9wbG90X29yaWcuaWRlbnQgPSBEaW1QbG90KGdlb19zbywgZ3JvdXAuYnkgPSAnb3JpZy5pZGVudCcsIGxhYmVsID0gRkFMU0UsIHJlZHVjdGlvbiA9ICd1bWFwLnNjdC5pbnRlZ3JhdGVkLmNjYScpICsgTm9MZWdlbmQoKQpnZ3NhdmUoZmlsZW5hbWUgPSAnSVNDX1IvcmVzdWx0cy9maWd1cmVzL3VtYXBfaW50ZWdyYXRlZF9zY3Rfb3JpZy5pZGVudC5wbmcnLCBwbG90ID0gcG9zdF9pbnRlZ3JhdGlvbl91bWFwX3Bsb3Rfb3JpZy5pZGVudCkKYGBgCgohW10oLi9pbWFnZXMvY3VycmljdWx1bS91bWFwX2ludGVncmF0ZWRfc2N0X29yaWcuaWRlbnQucG5nKQoKCgpXZSBjYW4gYWxzbyBldmFsdWF0ZSBjbHVzdGVyIG1lbWJlcnNoaXAgYnkgYG9yaWcuaWRlbnRgIG9yIGJ5IGBkYXlgIHVzaW5nIHRoZSBgdGFibGUoKWAgZnVuY3Rpb246CgoKYGBge3IsIGV2YWw9RkFMU0V9CnRhYmxlKGdlb19zb0BtZXRhLmRhdGEkb3JpZy5pZGVudCwgZ2VvX3NvQG1ldGEuZGF0YSRpbnRlZ3JhdGVkLnNjdC5jY2EuY2x1c3RlcnMpCgoKYGBgCgoKIyBPdGhlciBhcHByb2FjaGVzIGZvciB2aXN1YWxpemluZyBzY1JOQS1zcSBkYXRhCgp0U05FLCBQQ0EKCgojIENvbXBhcmluZyB0byB1bmludGVncmF0ZWQgZGF0YQoKSWYgd2UgaGFkIHByb2NlZWRlZCB3aXRoIG91ciBmaWx0ZXJlZCBkYXRhIGFuZCBvbmx5IG5vcm1hbGl6ZWQgb3VyIGRhdGEgd2l0aG91dCBkb2luZyBhbnkgaW50ZWdyYXRpb24sIGluY2x1ZGluZyB0aHJvdWdoIHRoZSBkaW1lbnNpb25hbGl0eSByZWR1Y3Rpb24gYW5kIGNsdXN0ZXJpbmcgc3RlcHMgYW5kIHRoZW4gbGFiZWxlZCB0aGUgY2VsbHMgd2l0aCB0aGVpciBzYW1wbGUgb2Ygb3JpZ2luLCB0aGVuIHdlIHdvdWxkIHNlZSB0aGUgZm9sbG93aW5nIGZvciBvdXIgZGF0YToKCjwhLS1BZGQgZXhhbXBsZSBvZiBVTUFQIC8gc2FtcGxlIGxhYmVscyBmb3IgdW5pbnRlZ3JhdGVkIGRhdGEgZnJvbSBhbmFseXNpcyBmb2xkZXIgdG8gaW1hZ2VzLS0+CgohW10odW1hcF9jb21wYXJpc29uX3NjdC5wbmcpCgoKCkluIHRoaXMgcGxvdCwgd2UgLi4uIHNlZSB0aGF0IHdoaWxlIHRoZXJlIGFyZSBkaXN0aW5jdCBjbHVzdGVycywgdGhvc2UgY2x1c3RlcnMgc2VlbSB0byBzZXBhcmF0ZSBwcmltYXJpbHkgYnkgc2FtcGxlIGlkLiBUaGlzIHN1Z2dlc3RzIHRoYXQgd2l0aG91dCBpbnRlZ3JhdGlvbiwgdGhlc2UgYmF0Y2ggZWZmZWN0cyBjb3VsZCBza2V3IHRoZSBiaW9sb2dpY2FsIHZhcmlhYmlsaXR5IGluIG91ciBkYXRhLiA8IS0tbW92ZSB0aGlzIHNlY3Rpb24gdG8gZW5kIG9mIFByb2plY3Rpb24gbW9kdWxlIHRvIGNvbnRyYXN0IHdpdGggaW50ZWdyYXRlZCByZXN1bHRzLS0+CgoKPCEtLSBFZGl0IHNlY3Rpb24gdG8gaW5jb3Jwb3JhdGUgLS0tPgoKIyBSZXdpbmQ6IFByZS1pbnRlZ3JhdGlvbiBldmFsdWF0aW9uCgpQcmlvciB0byBpbnRlZ3JhdGlvbiwgd2Ugd291bGQgbGlrZSB0byBrbm93IGlmIHRoZXJlIGFyZSBhbnkgYmF0Y2ggZWZmZWN0cyB0aGF0IGNhcnJ5IHRocm91Z2ggdG8gdGhlIGNlbGwgY2x1c3RlcnMuIE1vc3QgaW1wb3J0YW50bHksIHdlIHdvdWxkIGxpa2UgdG8ga25vdyBpZiBjbHVzdGVycyB0ZW5kIHRvIGJlIGRldGVybWluZWQgYnkgc2FtcGxlIG9yIGNvbmRpdGlvbiAoaW4gdGhpcyBjYXNlLCB0aGUgZGF5KS4gSW4gb3JkZXIgdG8gZmlndXJlIHRoaXMgb3V0IHdlIGhhdmUgYWxyZWFkeSBydW4gdGhlIGZvbGxvd2luZyB0aHJlZSBjb21tYW5kcywgd2hpY2ggd2Ugd2lsbCBkZXNjcmliZSBpbiBtb3JlIGRldGFpbCBsYXRlci4KCmBgYHtyLCBldmFsID0gRkFMU0V9CiMgRGVmYXVsdEFzc2F5KGdlb19zbykgPSAnUk5BJwoKZ2VvX3NvID0gUnVuUENBKGdlb19zbywgcmVkdWN0aW9uLm5hbWUgPSAndW5pbnRlZ3JhdGVkLnNjdC5wY2EnKQpnZW9fc28gPSBGaW5kTmVpZ2hib3JzKGdlb19zbywgZGltcyA9IDE6MjUsIHJlZHVjdGlvbiA9ICd1bmludGVncmF0ZWQuc2N0LnBjYScpCmdlb19zbyA9IEZpbmRDbHVzdGVycyhnZW9fc28sIHJlc29sdXRpb24gPSAwLjUsIGNsdXN0ZXIubmFtZSA9ICd1bmludGVncmF0ZWQuc2N0LmNsdXN0ZXJzJykKZ2VvX3NvID0gUnVuVU1BUChnZW9fc28sIGRpbXMgPSAxOjI1LCByZWR1Y3Rpb24gPSAndW5pbnRlZ3JhdGVkLnNjdC5wY2EnLCByZWR1Y3Rpb24ubmFtZSA9ICd1bWFwLnVuaW50ZWdyYXRlZC5zY3QucGNhJykKYGBgCgoKRnJvbSB0aGlzIGltYWdlLCB3ZSBjYW4gcXVhbGl0YXRpdmVseSBzZWUgdGhhdCBzb21lIGNsdXN0ZXJzIHNlZW0gdG8gYmUgZHJpdmVuIGJ5IHRoZSBvcmlnaW5hbCBpZGVudGl0eS4gV2UgY2FuIHNlZSB0aGlzIGV2ZW4gbW9yZSBjbGVhcmx5IGlmIHdlIHVzZSBgZ3JvdXAuYnkgPSAnZGF5J2A6CgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpwcmVfaW50ZWdyYXRpb25fdW1hcF9wbG90ID0gRGltUGxvdChnZW9fc28sIGdyb3VwLmJ5ID0gJ2RheScsIGxhYmVsID0gRkFMU0UsIHJlZHVjdGlvbiA9ICd1bWFwLnVuaW50ZWdyYXRlZC5zY3QucGNhJykgKyBOb0xlZ2VuZCgpCmdnc2F2ZShmaWxlbmFtZSA9ICdJU0NfUi9yZXN1bHRzL2ZpZ3VyZXMvdW1hcF91bmludGVncmF0ZWRfc2N0X2RheS5wbmcnLCBwbG90ID0gcHJlX2ludGVncmF0aW9uX3VtYXBfcGxvdCkKYGBgCgohW10oLi9pbWFnZXMvY3VycmljdWx1bS91bWFwX3VuaW50ZWdyYXRlZF9zY3RfZGF5LnBuZykKCgo8IS0tIE1ha2Ugc3VyZSBhYm92ZSBzZWN0aW9uIGlzIGVkaXRlZCAtLT4KCiMgU3VtbWFyeQoKTm93IHRoYXQgd2UgaGF2ZSAuLi4KCk5leHQgc3RlcHM6IE1hcmtlciBnZW5lcwoKCi0tLS0KClRoZXNlIG1hdGVyaWFscyBoYXZlIGJlZW4gYWRhcHRlZCBhbmQgZXh0ZW5kZWQgZnJvbSBtYXRlcmlhbHMgbGlzdGVkIGFib3ZlLiBUaGVzZSBhcmUgb3BlbiBhY2Nlc3MgbWF0ZXJpYWxzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgW0NyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24gbGljZW5zZSAoQ0MgQlkgNC4wKV0oaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvNC4wLyksIHdoaWNoIHBlcm1pdHMgdW5yZXN0cmljdGVkIHVzZSwgZGlzdHJpYnV0aW9uLCBhbmQgcmVwcm9kdWN0aW9uIGluIGFueSBtZWRpdW0sIHByb3ZpZGVkIHRoZSBvcmlnaW5hbCBhdXRob3IgYW5kIHNvdXJjZSBhcmUgY3JlZGl0ZWQuCgo8YnIvPgo8YnIvPgo8aHIvPgp8IFtQcmV2aW91cyBsZXNzb25dKDA0LVBDQWFuZERpbVJlZHVjdGlvbi5odG1sKSB8IFtUb3Agb2YgdGhpcyBsZXNzb25dKCN0b3ApIHwgW05leHQgbGVzc29uXSgwNi1NYXJrZXJWaXN1YWxpemF0aW9uLmh0bWwpIHwKfCA6LS0tIHwgOi0tLS06IHwgLS0tOiB8Cgo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("05-ProjectionAndClustering.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
