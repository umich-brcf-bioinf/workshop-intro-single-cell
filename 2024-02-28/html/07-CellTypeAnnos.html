<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2024-02-27" />

<title>Cell Type Annotation</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<!--
Favicon dervied from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="shortcut icon" href="favicon-16x16.png" />
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to scRNA-Seq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="workshop_intro.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00A-OrientingOnScRNASeq.html">Orienting on scRNA-Seq</a>
    </li>
    <li>
      <a href="00B-CellRangerInAction.html">Cell Ranger in Action</a>
    </li>
    <li>
      <a href="01-GettingStarted.html">Getting Started with Seurat</a>
    </li>
    <li>
      <a href="02-QCandFiltering.html">Secondary QC &amp; Filtering</a>
    </li>
    <li>
      <a href="03-Normalization.html">Normalization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04-PCAandIntegration.html">PCA &amp; Integration</a>
    </li>
    <li>
      <a href="05-ProjectionAndClustering.html">Projection &amp; Clustering</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Day 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-MarkerVisualization.html">Marker identification and visualization</a>
    </li>
    <li>
      <a href="07-CellTypeAnnos.html">Cell type annotation</a>
    </li>
    <li>
      <a href="08-DifferentialExpression.html">Differential expression analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="workshop_wrap_up.html">Wrap up</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Cell Type Annotation</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2024-02-27</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<div id="workflow-overview" class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Workflow Overview</h1>
<p><br/>
<img src="images/wayfinder/wayfinder.png" alt="wayfinder" style="height: 400px;"/>
<br/> <br/></p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>General goal: Filtering out the “cells” that either were poorly
measured or are either not single-cells or not cells at all</p>
<!-- Point out possible gaps between how single-cell data is presented versus the reality of running an analysis
E.g. Papers might report final filtering thresholds, but our process for choosing those is likely to be more iterative -->
<p>Even more so than the previous sections, cell type annotation is
…</p>
<div id="objectives" class="section level2">
<h2>Objectives</h2>
<!--Add specific goals for section-->
<hr />
</div>
</div>
<div id="cell-type-predictions" class="section level1">
<h1>Cell type predictions</h1>
<!-- [OSCA](https://bioconductor.org/books/3.15/OSCA.basic/cell-type-annotation.html) "The most challenging task in scRNA-seq data analysis is arguably the interpretation of the results. Obtaining clusters of cells is fairly straightforward, but it is more difficult to determine what biological state is represented by each of those clusters. Doing so requires us to bridge the gap between the current dataset and prior biological knowledge, and the latter is not always available in a consistent and quantitative manner. Indeed, even the concept of a “cell type” is not clearly defined, with most practitioners possessing a “I’ll know it when I see it” intuition that is not amenable to computational analysis. As such, interpretation of scRNA-seq data is often manual and a common bottleneck in the analysis workflow." -->
<!--For mouse, we often use scCATCH-->
<!--More options for human samples than mouse-->
<p>For human, if a relevant reference is available would recommend using
<a href="https://azimuth.hubmapconsortium.org/">Azimuth (created by
authors of Seurat)</a>
<!-- and [10x tutorial](https://www.10xgenomics.com/analysis-guides/automated-cell-type-annotation-from-r-to-loupe-using-louper) that includes example of using Azimuth --></p>
<p>Other tools?</p>
<!-- [sc best practices](https://www.sc-best-practices.org/cellular_structure/annotation.html#automated-annotation) -->
</div>
<div id="using-sccatch" class="section level1">
<h1>Using scCATCH</h1>
<!--- add context about scCATCH--->
<p>Load the scCATCH library</p>
<pre class="r"><code>library(scCATCH)</code></pre>
<p>Check that we are using the expected resolution cluster results</p>
<pre class="r"><code>all(Idents(geo_so) == geo_so$SCT_snn_res.0.4)</code></pre>
<p>Create scCATCH object</p>
<pre class="r"><code>geo_catch = createscCATCH(data = geo_so@assays$SCT@counts, cluster = as.character(Idents(geo_so)))</code></pre>
<p>Convert marker genes to scCATCH compatible format and add to scCATCH
object</p>
<pre class="r"><code>catch_markers = geo_markers %&gt;% rename(&#39;logfc&#39; = &#39;avg_log2FC&#39;)

geo_catch@markergene = geo_markers</code></pre>
<p>Create query for database &amp; run tool</p>
<pre class="r"><code>geo_catch@marker = cellmatch[cellmatch$species == &#39;Mouse&#39; &amp; cellmatch$tissue %in% c(&#39;Blood&#39;, &#39;Peripheral Blood&#39;, &#39;Muscle&#39;, &#39;Skeletal muscle&#39;, &#39;Epidermis&#39;, &#39;Skin&#39;), ]

geo_catch = findcelltype(geo_catch)</code></pre>
<p>Look at our results, including cell type score</p>
<pre class="r"><code>geo_catch@celltype %&gt;% select(cluster, cell_type, celltype_score)</code></pre>
<p>Add celltype predictions to our Seurat object. Note that we will
create a new metadata object where we join cell types, this destroys
rownames which will cause a problem in Seurat, so we have to add them
back. We are implicitly relying on the same row order!</p>
<pre class="r"><code>catch_celltypes = geo_catch@celltype %&gt;% select(cluster, cell_type)


new_metadata = geo_so@meta.data %&gt;% left_join(catch_celltypes, by = c(&#39;SCT_snn_res.0.4&#39; = &#39;cluster&#39;))
rownames(new_metadata) = rownames(geo_so@meta.data)

geo_so@meta.data = new_metadata </code></pre>
<p>Create a UMAP plot with our new labels</p>
<pre class="r"><code>catch_umap_plot = DimPlot(geo_so, group.by = &#39;cell_type&#39;, label = TRUE, reduction = &#39;umap.sct.integrated.rpca&#39;)

ggsave(filename = &#39;ISC_R/results/figures/umap_integrated_catch.png&#39;, plot = catch_umap_plot, width = 8, height = 7, units = &#39;in&#39;)</code></pre>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Now that we have …</p>
<p>Next steps: Differential Expression</p>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="06-MarkerVisualization.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a href="08-DifferentialExpression.html">Next
lesson</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQ2VsbCBUeXBlIEFubm90YXRpb24iCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIGluY2x1ZGVzOgogICAgICAgICAgICAgICAgaW5faGVhZGVyOiBoZWFkZXIuaHRtbAogICAgICAgICAgICB0aGVtZTogcGFwZXIKICAgICAgICAgICAgdG9jOiB0cnVlCiAgICAgICAgICAgIHRvY19kZXB0aDogNAogICAgICAgICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgICAgICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMThweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxMnB4Cn0KPC9zdHlsZT4KCmBgYHtyLCBpbmNsdWRlID0gRkFMU0V9CnNvdXJjZSgiLi4vYmluL2NodW5rLW9wdGlvbnMuUiIpCmtuaXRyX2ZpZ19wYXRoKCJYWCIpCmBgYAoKIyBXb3JrZmxvdyBPdmVydmlldyB7LnVubGlzdGVkIC51bm51bWJlcmVkfQoKPGJyLz4KPGltZyBzcmM9ImltYWdlcy93YXlmaW5kZXIvd2F5ZmluZGVyLnBuZyIgYWx0PSJ3YXlmaW5kZXIiIHN0eWxlPSJoZWlnaHQ6IDQwMHB4OyIvPgo8YnIvPgo8YnIvPgoKIyBJbnRyb2R1Y3Rpb24KCkdlbmVyYWwgZ29hbDogRmlsdGVyaW5nIG91dCB0aGUgImNlbGxzIiB0aGF0IGVpdGhlciB3ZXJlIHBvb3JseSBtZWFzdXJlZCBvciBhcmUgZWl0aGVyIG5vdCBzaW5nbGUtY2VsbHMgb3Igbm90IGNlbGxzIGF0IGFsbAoKPCEtLSBQb2ludCBvdXQgcG9zc2libGUgZ2FwcyBiZXR3ZWVuIGhvdyBzaW5nbGUtY2VsbCBkYXRhIGlzIHByZXNlbnRlZCB2ZXJzdXMgdGhlIHJlYWxpdHkgb2YgcnVubmluZyBhbiBhbmFseXNpcwpFLmcuIFBhcGVycyBtaWdodCByZXBvcnQgZmluYWwgZmlsdGVyaW5nIHRocmVzaG9sZHMsIGJ1dCBvdXIgcHJvY2VzcyBmb3IgY2hvb3NpbmcgdGhvc2UgaXMgbGlrZWx5IHRvIGJlIG1vcmUgaXRlcmF0aXZlIC0tPgoKRXZlbiBtb3JlIHNvIHRoYW4gdGhlIHByZXZpb3VzIHNlY3Rpb25zLCBjZWxsIHR5cGUgYW5ub3RhdGlvbiBpcyAuLi4KCiMjIE9iamVjdGl2ZXMKCjwhLS1BZGQgc3BlY2lmaWMgZ29hbHMgZm9yIHNlY3Rpb24tLT4KCi0tLS0KCiMgQ2VsbCB0eXBlIHByZWRpY3Rpb25zCgo8IS0tIFtPU0NBXShodHRwczovL2Jpb2NvbmR1Y3Rvci5vcmcvYm9va3MvMy4xNS9PU0NBLmJhc2ljL2NlbGwtdHlwZS1hbm5vdGF0aW9uLmh0bWwpICJUaGUgbW9zdCBjaGFsbGVuZ2luZyB0YXNrIGluIHNjUk5BLXNlcSBkYXRhIGFuYWx5c2lzIGlzIGFyZ3VhYmx5IHRoZSBpbnRlcnByZXRhdGlvbiBvZiB0aGUgcmVzdWx0cy4gT2J0YWluaW5nIGNsdXN0ZXJzIG9mIGNlbGxzIGlzIGZhaXJseSBzdHJhaWdodGZvcndhcmQsIGJ1dCBpdCBpcyBtb3JlIGRpZmZpY3VsdCB0byBkZXRlcm1pbmUgd2hhdCBiaW9sb2dpY2FsIHN0YXRlIGlzIHJlcHJlc2VudGVkIGJ5IGVhY2ggb2YgdGhvc2UgY2x1c3RlcnMuIERvaW5nIHNvIHJlcXVpcmVzIHVzIHRvIGJyaWRnZSB0aGUgZ2FwIGJldHdlZW4gdGhlIGN1cnJlbnQgZGF0YXNldCBhbmQgcHJpb3IgYmlvbG9naWNhbCBrbm93bGVkZ2UsIGFuZCB0aGUgbGF0dGVyIGlzIG5vdCBhbHdheXMgYXZhaWxhYmxlIGluIGEgY29uc2lzdGVudCBhbmQgcXVhbnRpdGF0aXZlIG1hbm5lci4gSW5kZWVkLCBldmVuIHRoZSBjb25jZXB0IG9mIGEg4oCcY2VsbCB0eXBl4oCdIGlzIG5vdCBjbGVhcmx5IGRlZmluZWQsIHdpdGggbW9zdCBwcmFjdGl0aW9uZXJzIHBvc3Nlc3NpbmcgYSDigJxJ4oCZbGwga25vdyBpdCB3aGVuIEkgc2VlIGl04oCdIGludHVpdGlvbiB0aGF0IGlzIG5vdCBhbWVuYWJsZSB0byBjb21wdXRhdGlvbmFsIGFuYWx5c2lzLiBBcyBzdWNoLCBpbnRlcnByZXRhdGlvbiBvZiBzY1JOQS1zZXEgZGF0YSBpcyBvZnRlbiBtYW51YWwgYW5kIGEgY29tbW9uIGJvdHRsZW5lY2sgaW4gdGhlIGFuYWx5c2lzIHdvcmtmbG93LiIgLS0+Cgo8IS0tRm9yIG1vdXNlLCB3ZSBvZnRlbiB1c2Ugc2NDQVRDSC0tPgoKPCEtLU1vcmUgb3B0aW9ucyBmb3IgaHVtYW4gc2FtcGxlcyB0aGFuIG1vdXNlLS0+CgpGb3IgaHVtYW4sIGlmIGEgcmVsZXZhbnQgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZSB3b3VsZCByZWNvbW1lbmQgdXNpbmcgW0F6aW11dGggKGNyZWF0ZWQgYnkgYXV0aG9ycyBvZiBTZXVyYXQpXShodHRwczovL2F6aW11dGguaHVibWFwY29uc29ydGl1bS5vcmcvKSA8IS0tIGFuZCBbMTB4IHR1dG9yaWFsXShodHRwczovL3d3dy4xMHhnZW5vbWljcy5jb20vYW5hbHlzaXMtZ3VpZGVzL2F1dG9tYXRlZC1jZWxsLXR5cGUtYW5ub3RhdGlvbi1mcm9tLXItdG8tbG91cGUtdXNpbmctbG91cGVyKSB0aGF0IGluY2x1ZGVzIGV4YW1wbGUgb2YgdXNpbmcgQXppbXV0aCAtLT4KCk90aGVyIHRvb2xzPwoKPCEtLSBbc2MgYmVzdCBwcmFjdGljZXNdKGh0dHBzOi8vd3d3LnNjLWJlc3QtcHJhY3RpY2VzLm9yZy9jZWxsdWxhcl9zdHJ1Y3R1cmUvYW5ub3RhdGlvbi5odG1sI2F1dG9tYXRlZC1hbm5vdGF0aW9uKSAtLT4KCiMgVXNpbmcgc2NDQVRDSAoKPCEtLS0gYWRkIGNvbnRleHQgYWJvdXQgc2NDQVRDSC0tLT4KCkxvYWQgdGhlIHNjQ0FUQ0ggbGlicmFyeQpgYGB7ciwgZXZhbD1GQUxTRX0KbGlicmFyeShzY0NBVENIKQpgYGAKCkNoZWNrIHRoYXQgd2UgYXJlIHVzaW5nIHRoZSBleHBlY3RlZCByZXNvbHV0aW9uIGNsdXN0ZXIgcmVzdWx0cwpgYGB7ciwgZXZhbD1GQUxTRX0KYWxsKElkZW50cyhnZW9fc28pID09IGdlb19zbyRTQ1Rfc25uX3Jlcy4wLjQpCmBgYAoKQ3JlYXRlIHNjQ0FUQ0ggb2JqZWN0CmBgYHtyLCBldmFsPUZBTFNFfQpnZW9fY2F0Y2ggPSBjcmVhdGVzY0NBVENIKGRhdGEgPSBnZW9fc29AYXNzYXlzJFNDVEBjb3VudHMsIGNsdXN0ZXIgPSBhcy5jaGFyYWN0ZXIoSWRlbnRzKGdlb19zbykpKQpgYGAKCkNvbnZlcnQgbWFya2VyIGdlbmVzIHRvIHNjQ0FUQ0ggY29tcGF0aWJsZSBmb3JtYXQgYW5kIGFkZCB0byBzY0NBVENIIG9iamVjdApgYGB7ciwgZXZhbD1GQUxTRX0KY2F0Y2hfbWFya2VycyA9IGdlb19tYXJrZXJzICU+JSByZW5hbWUoJ2xvZ2ZjJyA9ICdhdmdfbG9nMkZDJykKCmdlb19jYXRjaEBtYXJrZXJnZW5lID0gZ2VvX21hcmtlcnMKYGBgCgpDcmVhdGUgcXVlcnkgZm9yIGRhdGFiYXNlICYgcnVuIHRvb2wKYGBge3IsIGV2YWw9RkFMU0V9Cmdlb19jYXRjaEBtYXJrZXIgPSBjZWxsbWF0Y2hbY2VsbG1hdGNoJHNwZWNpZXMgPT0gJ01vdXNlJyAmIGNlbGxtYXRjaCR0aXNzdWUgJWluJSBjKCdCbG9vZCcsICdQZXJpcGhlcmFsIEJsb29kJywgJ011c2NsZScsICdTa2VsZXRhbCBtdXNjbGUnLCAnRXBpZGVybWlzJywgJ1NraW4nKSwgXQoKZ2VvX2NhdGNoID0gZmluZGNlbGx0eXBlKGdlb19jYXRjaCkKYGBgCgoKTG9vayBhdCBvdXIgcmVzdWx0cywgaW5jbHVkaW5nIGNlbGwgdHlwZSBzY29yZQpgYGB7ciwgZXZhbD1GQUxTRX0KZ2VvX2NhdGNoQGNlbGx0eXBlICU+JSBzZWxlY3QoY2x1c3RlciwgY2VsbF90eXBlLCBjZWxsdHlwZV9zY29yZSkKYGBgCgpBZGQgY2VsbHR5cGUgcHJlZGljdGlvbnMgdG8gb3VyIFNldXJhdCBvYmplY3QuIE5vdGUgdGhhdCB3ZSB3aWxsIGNyZWF0ZSBhIG5ldyBtZXRhZGF0YSBvYmplY3Qgd2hlcmUgd2Ugam9pbiBjZWxsIHR5cGVzLCB0aGlzIGRlc3Ryb3lzIHJvd25hbWVzIHdoaWNoIHdpbGwgY2F1c2UgYSBwcm9ibGVtIGluIFNldXJhdCwgc28gd2UgaGF2ZSB0byBhZGQgdGhlbSBiYWNrLiBXZSBhcmUgaW1wbGljaXRseSByZWx5aW5nIG9uIHRoZSBzYW1lIHJvdyBvcmRlciEKYGBge3IsIGV2YWw9RkFMU0V9CmNhdGNoX2NlbGx0eXBlcyA9IGdlb19jYXRjaEBjZWxsdHlwZSAlPiUgc2VsZWN0KGNsdXN0ZXIsIGNlbGxfdHlwZSkKCgpuZXdfbWV0YWRhdGEgPSBnZW9fc29AbWV0YS5kYXRhICU+JSBsZWZ0X2pvaW4oY2F0Y2hfY2VsbHR5cGVzLCBieSA9IGMoJ1NDVF9zbm5fcmVzLjAuNCcgPSAnY2x1c3RlcicpKQpyb3duYW1lcyhuZXdfbWV0YWRhdGEpID0gcm93bmFtZXMoZ2VvX3NvQG1ldGEuZGF0YSkKCmdlb19zb0BtZXRhLmRhdGEgPSBuZXdfbWV0YWRhdGEgCmBgYAoKQ3JlYXRlIGEgVU1BUCBwbG90IHdpdGggb3VyIG5ldyBsYWJlbHMKYGBge3IsIGV2YWw9RkFMU0V9CmNhdGNoX3VtYXBfcGxvdCA9IERpbVBsb3QoZ2VvX3NvLCBncm91cC5ieSA9ICdjZWxsX3R5cGUnLCBsYWJlbCA9IFRSVUUsIHJlZHVjdGlvbiA9ICd1bWFwLnNjdC5pbnRlZ3JhdGVkLnJwY2EnKQoKZ2dzYXZlKGZpbGVuYW1lID0gJ0lTQ19SL3Jlc3VsdHMvZmlndXJlcy91bWFwX2ludGVncmF0ZWRfY2F0Y2gucG5nJywgcGxvdCA9IGNhdGNoX3VtYXBfcGxvdCwgd2lkdGggPSA4LCBoZWlnaHQgPSA3LCB1bml0cyA9ICdpbicpCmBgYAoKCgojIFN1bW1hcnkKCk5vdyB0aGF0IHdlIGhhdmUgLi4uIAoKTmV4dCBzdGVwczogRGlmZmVyZW50aWFsIEV4cHJlc3Npb24KCgoKLS0tLQoKVGhlc2UgbWF0ZXJpYWxzIGhhdmUgYmVlbiBhZGFwdGVkIGFuZCBleHRlbmRlZCBmcm9tIG1hdGVyaWFscyBsaXN0ZWQgYWJvdmUuIFRoZXNlIGFyZSBvcGVuIGFjY2VzcyBtYXRlcmlhbHMgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBbQ3JlYXRpdmUgQ29tbW9ucyBBdHRyaWJ1dGlvbiBsaWNlbnNlIChDQyBCWSA0LjApXShodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS80LjAvKSwgd2hpY2ggcGVybWl0cyB1bnJlc3RyaWN0ZWQgdXNlLCBkaXN0cmlidXRpb24sIGFuZCByZXByb2R1Y3Rpb24gaW4gYW55IG1lZGl1bSwgcHJvdmlkZWQgdGhlIG9yaWdpbmFsIGF1dGhvciBhbmQgc291cmNlIGFyZSBjcmVkaXRlZC4KCjxici8+Cjxici8+Cjxoci8+CnwgW1ByZXZpb3VzIGxlc3Nvbl0oMDYtTWFya2VyVmlzdWFsaXphdGlvbi5odG1sKSB8IFtUb3Agb2YgdGhpcyBsZXNzb25dKCN0b3ApIHwgW05leHQgbGVzc29uXSgwOC1EaWZmZXJlbnRpYWxFeHByZXNzaW9uLmh0bWwpIHwKfCA6LS0tIHwgOi0tLS06IHwgLS0tOiB8Cgo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("07-CellTypeAnnos.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
